<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yrf990409.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
<meta property="og:type" content="website">
<meta property="og:title" content="Runfeng的万事屋">
<meta property="og:url" content="https://yrf990409.github.io/index.html">
<meta property="og:site_name" content="Runfeng的万事屋">
<meta property="og:description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Yu Runfeng">
<meta property="article:tag" content="运筹, 物流, OR">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://yrf990409.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Runfeng的万事屋</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Runfeng的万事屋</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">随便写写啦,反正没人看</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Yu Runfeng</p>
  <div class="site-description" itemprop="description">个人学习记录, 一些运筹, 一些代码, 一些吐槽</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yrf990409" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yrf990409" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2025/04/26/2025-04-26-slide-make/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/04/26/2025-04-26-slide-make/" class="post-title-link" itemprop="url">团队协作PPT指南</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-04-26 18:47:19 / 修改时间：18:54:09" itemprop="dateCreated datePublished" datetime="2025-04-26T18:47:19+08:00">2025-04-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="工具与工具版本"><a class="markdownIt-Anchor" href="#工具与工具版本"></a> 工具与工具版本</h1>
<p><strong>使用power point 2019+或office 365</strong>，不要使用WPS以避免与office混用的格式错误。</p>
<p>使用2019+版本的原因是部分功能（例如，平滑切换）在此版本加入，另外使用旧版本的Office（可能）有潜在的兼容性问题。</p>
<h1 id="制作原则"><a class="markdownIt-Anchor" href="#制作原则"></a> 制作原则</h1>
<ul>
<li><strong>最小化外部依赖</strong>： 能在 ppt 内部实现的 不要用外部软件（mathtype公式，简单画图，简单调色等）</li>
<li><strong>尽可能复用</strong>：复用对象，避免新建对象导致字体、对齐不一致等格式问题 ，一次实现，多次复制使用</li>
<li><strong>简单实现</strong>：能通过简单方法实现的效果，不要使用复杂方法</li>
</ul>
<h1 id="命名与文件版本"><a class="markdownIt-Anchor" href="#命名与文件版本"></a> 命名与文件版本</h1>
<p><strong>PPT命名规则为</strong> <code>项目名_版本号_月份(英大写)_日期_修改人_修改内容概述</code></p>
<p>例如：<code>新朔_0.0.1_APR_18_YRF_新建文档</code></p>
<p>其中，<strong>版本号</strong>使用<code>语义化版本（Semantic Versioning）</code></p>
<ol>
<li>主版本号：当你做了不兼容的修改（例如，换模板等<strong>颠覆性操作</strong>，与别人修改的版本再也无法兼容）</li>
<li>次版本号：当你做了向下兼容的功能性新增（例如，新增某个章节）</li>
<li>修订号：当你做了向下兼容的问题修正（例如，修改了错别字）</li>
</ol>
<p><strong>不要在任何时刻定义final版本，避免出现final-final-final版。</strong></p>
<p>应当有唯一一人负责版本合并，作为主分支</p>
<h1 id="日志"><a class="markdownIt-Anchor" href="#日志"></a> 日志</h1>
<p>每页ppt应该有从新建、修改、删除的详细日志</p>
<p>谁在什么时候做了什么修改，放在ppt图框外面的一个文本框内</p>
<p><code>2025.01.01 YRF 新建此页</code></p>
<p><code>2025.01.02 YRF 修改公式的动画</code></p>
<p><code>2025.01.05 YRF 新增切换样式</code></p>
<p><code>2025.01.05 SJY 因演讲超时弃用此页</code></p>
<h1 id="删除"><a class="markdownIt-Anchor" href="#删除"></a> 删除</h1>
<p>任何制作出来的页，在弃用时不应删除（不知何时会再次启用），应放置到所有页的末尾，并在日志中标明弃用及原因</p>
<h1 id="字体"><a class="markdownIt-Anchor" href="#字体"></a> 字体</h1>
<p>尽量<strong>不要</strong>将无衬线字体和有衬线字体<strong>混合排版</strong>，常用字体：</p>
<ul>
<li>无衬线字体
<ul>
<li>微软雅黑</li>
<li>Arial</li>
<li>黑体</li>
<li>等线</li>
<li>…</li>
</ul>
</li>
<li>有衬线字体
<ul>
<li>宋体</li>
<li>Times new Roman</li>
<li>…</li>
</ul>
</li>
</ul>
<h1 id="插图"><a class="markdownIt-Anchor" href="#插图"></a> 插图</h1>
<p>ppt插图尽量高清，低分辨率图片可用AI方法放大修复，例如 upscayl或bigjpg 等。</p>
<h1 id="配色"><a class="markdownIt-Anchor" href="#配色"></a> 配色</h1>
<p>ppt配色应围绕主题色进行修改，建议建立取色卡。</p>
<p>尽量不要使用亮度、饱和度过高的红色、绿色、黄色等。</p>
<p>不建议同一页面使用过多颜色搭配，建议使用同色系颜色进行搭配。</p>
<h1 id="动画"><a class="markdownIt-Anchor" href="#动画"></a> 动画</h1>
<p>动画应简洁、美观、丝滑、快速（不宜过长等待）。动画应当辅助核心内容，而不是为了制作动画而制作。</p>
<h1 id="文件管理"><a class="markdownIt-Anchor" href="#文件管理"></a> 文件管理</h1>
<p>保留<strong>可编辑</strong>的素材、源图、公式等，避免二次制作。</p>
<h1 id="风格"><a class="markdownIt-Anchor" href="#风格"></a> 风格</h1>
<p>扁平风格<strong>不要</strong>与写实或立体风格混用</p>
<h1 id="背景"><a class="markdownIt-Anchor" href="#背景"></a> 背景</h1>
<p>背景可以为白色，也可添加背景色，但不要使用带纹理的背景。</p>
<p>注意：若背景不为白色，则不要使用白色块（原因：丑，像补丁）</p>
<h1 id="公式"><a class="markdownIt-Anchor" href="#公式"></a> 公式</h1>
<p>公式尽量使用ppt自带公式编辑器，不要插入图片，不用使用mathtype（可能无法编辑）</p>
<h1 id="表格"><a class="markdownIt-Anchor" href="#表格"></a> 表格</h1>
<p>表格要简洁，小数的小数点对齐且保留相同位数，整数统一右对齐</p>
<h1 id="地图"><a class="markdownIt-Anchor" href="#地图"></a> 地图</h1>
<p>使用地图一定要小心敏感地区：台湾、藏南、香港是我国领土的一部分。</p>
<h1 id="在线协作"><a class="markdownIt-Anchor" href="#在线协作"></a> 在线协作</h1>
<p>微软office 365与onedrive目前有在线协作的功能，可作为主分支进行合并以及最后的共同校验。</p>
<h1 id="杂项"><a class="markdownIt-Anchor" href="#杂项"></a> 杂项</h1>
<p>善用锁定和组合，善用内部文字左右居中对齐、对象排列</p>
<p>考虑去除句尾的句号</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/11/22/2024-11-22-CMake%E5%92%8CGurobi%E8%81%94%E5%90%88%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/22/2024-11-22-CMake%E5%92%8CGurobi%E8%81%94%E5%90%88%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">CMake和Gurobi联合使用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-11-22 16:48:46 / 修改时间：17:46:35" itemprop="dateCreated datePublished" datetime="2024-11-22T16:48:46+08:00">2024-11-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>以往都是用Python调用Gurobi进行数学规划建模，最近开始涉及C<ins>的编程。由于不想使用C</ins>和python联合编程（也许是C<ins>调用一个Python解释器？总之，没这样去做），所以直接用C</ins>调用Gurobi了。<br>
由于我用的是mac，因此<code>VScode + Cmake</code>是最佳的组合，本文主要记录的是Cmake文件应该如何编写。(<strong>Windows系统请不要参考这个教程，不能保证正确性</strong>)</p>
<p>首先，这是Gurobi官方的链接：<br>
<a target="_blank" rel="noopener" href="https://support.gurobi.com/hc/en-us/articles/360039499751-How-do-I-use-CMake-to-build-Gurobi-C-C-projects">https://support.gurobi.com/hc/en-us/articles/360039499751-How-do-I-use-CMake-to-build-Gurobi-C-C-projects</a></p>
<p>按照官方的链接，在Gurobi正确安装的情况下， <code>mip1_c++.cpp</code>亲测可以运行。如果发现，上述的教程不能通过Cmake编译，且原因是找不到Gurobi，那大概率是Gurobi的环境变量设置的有问题了，需要修改环境变量到指定的路径，<br>
这里放上macos的<code>.zshrc</code>设置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GUROBI_LICENSE_FILE=/Users/yurunfeng/gurobi.lic</span><br><span class="line"><span class="built_in">export</span> GUROBI_HOME=/Library/gurobi1103/macos_universal2</span><br></pre></td></tr></table></figure>
<p>配置好环境变量，编译应该就没问题了。</p>
<p>在自己的项目中，把<code>FindGUROBI.cmake</code>文件直接放在工程目录中， <code>CmakeLists.txt</code> <strong>需要自己更改</strong>。<code>FindGUROBI.cmake</code>也可根据需要进行更改，<br>
比如以下这个例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CmakeLists.txt </span></span><br><span class="line"><span class="comment"># 这只是一个例子，如果不知道是什么意思的话，不要直接抄，肯定是运行不了的</span></span><br><span class="line">cmake_minimum_required(VERSION 3.29)</span><br><span class="line">cmake_policy(SET CMP0167 NEW)</span><br><span class="line">enable_language(CXX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set(CMAKE_OSX_ARCHITECTURES &quot;arm64&quot;)</span></span><br><span class="line"><span class="comment"># set(GUROBI_INCLUDE_DIRS &quot;/Library/gurobi1103/macos_universal2/include&quot;)  </span></span><br><span class="line"><span class="comment"># set(GUROBI_CXX_LIBRARY &quot;/Library/gurobi1103/macos_universal2/lib/libgurobi_c++.a&quot;) </span></span><br><span class="line"><span class="built_in">set</span>(CMAKE_PREFIX_PATH <span class="string">&quot;/Users/yurunfeng/vcpkg/installed/arm64-osx/share&quot;</span>)</span><br><span class="line"><span class="built_in">set</span>(CMAKE_BUILD_TYPE <span class="string">&quot;Debug&quot;</span>)</span><br><span class="line"><span class="built_in">set</span>(CMAKE_EXPORT_COMPILE_COMMANDS 1)</span><br><span class="line"><span class="built_in">set</span>(CMAKE_CXX_STANDARD 20)</span><br><span class="line"><span class="built_in">set</span>(CMAKE_CXX_STANDARD_REQUIRED True)</span><br><span class="line"><span class="built_in">set</span>(CXXFLAGS -D_GNU_SOURCE True)</span><br><span class="line"></span><br><span class="line">project(FWPSP)</span><br><span class="line"></span><br><span class="line">list(APPEND CMAKE_MODULE_PATH <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>)</span><br><span class="line"></span><br><span class="line">find_package(nlohmann_json CONFIG REQUIRED) <span class="comment"># json </span></span><br><span class="line">find_package(Boost REQUIRED COMPONENTS program_options stacktrace_basic stacktrace_noop system)</span><br><span class="line">find_package(Boost REQUIRED COMPONENTS <span class="built_in">log</span> log_setup thread filesystem system date_time regex)</span><br><span class="line">find_package(GUROBI REQUIRED)</span><br><span class="line"></span><br><span class="line">include_directories(<span class="variable">$&#123;GUROBI_INCLUDE_DIRS&#125;</span>)</span><br><span class="line">include_directories(<span class="variable">$&#123;Boost_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>(sources </span><br><span class="line">  src/main.cpp</span><br><span class="line">  src/alg_config.cpp</span><br><span class="line">  src/log_config.cpp</span><br><span class="line">  src/ip_model.cpp</span><br><span class="line">  src/data_loader.cpp</span><br><span class="line">  src/cbs_node.cpp</span><br><span class="line">  src/cbs.cpp</span><br><span class="line">  src/node_manager.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">add_executable(<span class="variable">$&#123;CMAKE_PROJECT_NAME&#125;</span> <span class="variable">$&#123;sources&#125;</span>)</span><br><span class="line"></span><br><span class="line">target_include_directories(FWPSP PRIVATE <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/inc)</span><br><span class="line">target_link_libraries(<span class="variable">$&#123;CMAKE_PROJECT_NAME&#125;</span> </span><br><span class="line">        nlohmann_json::nlohmann_json </span><br><span class="line">        <span class="variable">$&#123;Boost_LIBRARIES&#125;</span></span><br><span class="line">        <span class="variable">$&#123;GUROBI_LIBRARY&#125;</span></span><br><span class="line">        optimized <span class="variable">$&#123;GUROBI_CXX_LIBRARY&#125;</span></span><br><span class="line">        debug <span class="variable">$&#123;GUROBI_CXX_LIBRARY&#125;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span> STREQUAL <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>)</span><br><span class="line">  include(FeatureSummary)</span><br><span class="line">  feature_summary(WHAT ALL)</span><br><span class="line">endif()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>总之，重点在于如何告诉Cmake链接到Gurobi，如果某个环节错了的话，那就检查这个环节的问题，Cmake不熟悉也只能多学习Cmake了（因为我也不熟悉啊🥹）。<br>
此外，如果Gurobi的环境变量没设置也没关系，上述的<code>CmakeLists.txt</code>被注释的部分就是设置Gurobi的路径(macos)：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>(GUROBI_INCLUDE_DIRS <span class="string">&quot;/Library/gurobi1103/macos_universal2/include&quot;</span>)  </span><br><span class="line"><span class="built_in">set</span>(GUROBI_CXX_LIBRARY <span class="string">&quot;/Library/gurobi1103/macos_universal2/lib/libgurobi_c++.a&quot;</span>) </span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/10/22/2024-10-22-latex-model-composing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/22/2024-10-22-latex-model-composing/" class="post-title-link" itemprop="url">Latex排版优化模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-22 21:11:31" itemprop="dateCreated datePublished" datetime="2024-10-22T21:11:31+08:00">2024-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-23 10:03:21" itemprop="dateModified" datetime="2024-10-23T10:03:21+08:00">2024-10-23</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在使用Latex写作时，经常遇到数学优化模型的排版问题。在一般情况下，我希望写一个具有最小化\最大化的目标公式，<br>
约束、以及“subject to: ”或者“s.t.: ”这样的约束前缀。<br>
完成这样的任务涉及到一些Latex公式对齐的问题, 经过测试，以下两个实现方式效果最佳。</p>
<h1 id="公式独立标号"><a class="markdownIt-Anchor" href="#公式独立标号"></a> 公式独立标号</h1>
<p>先放源码：</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align&#125;</span><br><span class="line">  <span class="built_in">&amp;</span> <span class="keyword">\min</span> Cx <span class="keyword">\label</span>&#123;eq:obj&#125; <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\mbox</span>&#123;subject to: &#125; <span class="keyword">\quad</span> <span class="built_in">&amp;</span> Ax = b <span class="keyword">\label</span>&#123;eq:constr&#125; <span class="keyword">\\</span></span><br><span class="line">  <span class="built_in">&amp;</span> x <span class="keyword">\ge</span> 0</span><br><span class="line"><span class="keyword">\end</span>&#123;align&#125;</span><br></pre></td></tr></table></figure>
<p>编译结果如下：</p>
<p><img src="/2024/10/22/2024-10-22-latex-model-composing/model_align.png" alt="Latex"></p>
<h1 id="公式共用一个编号适合多个模型的情况"><a class="markdownIt-Anchor" href="#公式共用一个编号适合多个模型的情况"></a> 公式共用一个编号（适合多个模型的情况）</h1>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;subequations&#125;</span><br><span class="line"><span class="keyword">\label</span>&#123;eq:optim&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;align&#125;</span><br><span class="line">    <span class="keyword">\underset</span>&#123;X&#125;&#123;<span class="keyword">\text</span>&#123;minimize&#125;&#125;</span><br><span class="line">        <span class="built_in">&amp;</span> <span class="keyword">\quad</span> <span class="keyword">\mathrm</span>&#123;trace&#125;(X)   <span class="keyword">\label</span>&#123;eq:cost&#125;<span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\text</span>&#123;subject to&#125; </span><br><span class="line">        <span class="built_in">&amp;</span> <span class="keyword">\quad</span> X<span class="built_in">_</span>&#123;ij&#125; = M<span class="built_in">_</span>&#123;ij&#125;<span class="keyword">\,</span>, <span class="keyword">\;</span> (i,j) <span class="keyword">\in</span> <span class="keyword">\Omega</span><span class="keyword">\,</span>, <span class="keyword">\label</span>&#123;eq:const1&#125;<span class="keyword">\\</span></span><br><span class="line">        <span class="built_in">&amp;</span> <span class="keyword">\quad</span> X <span class="keyword">\succeq</span> 0 <span class="keyword">\,</span>. <span class="keyword">\label</span>&#123;eq:const2&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;align&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;subequations&#125;</span><br></pre></td></tr></table></figure>
<p>编译结果如下：</p>
<p><img src="/2024/10/22/2024-10-22-latex-model-composing/model_one_num.png" alt="Latex"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/09/30/2024-09-30-Gurobi%E6%9D%A1%E4%BB%B6%E7%BA%A6%E6%9D%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/30/2024-09-30-Gurobi%E6%9D%A1%E4%BB%B6%E7%BA%A6%E6%9D%9F/" class="post-title-link" itemprop="url">Gurobi条件约束</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-30 13:22:13" itemprop="dateCreated datePublished" datetime="2024-09-30T13:22:13+08:00">2024-09-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-06 11:26:08" itemprop="dateModified" datetime="2024-10-06T11:26:08+08:00">2024-10-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前几天刷到一个公众号上的推文，关于CVRP的两索引的建模，其中有一个约束是条件约束。<br>
之前我遇到条件约束都是手工转成线性约束，然后输入gurobi中，一方面是锻炼自己线性化的能力，另一方面是懒的翻手册查找方法。<br>
然后发现Gurobi是真好用，内置了条件约束的添加方法。</p>
<p>条件约束的广义形式见文章末尾的参考来源，这里只是举一个例子, 如下：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>→</mo><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msub><mi>q</mi><mi>i</mi></msub><mo>=</mo><msub><mi>u</mi><mi>j</mi></msub><mo separator="true">,</mo><mspace width="1em"><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>∈</mo><mi>A</mi><mo separator="true">,</mo><mi>j</mi><mo mathvariant="normal">≠</mo><mn>0</mn><mo separator="true">,</mo><mi>i</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mspace></mrow><annotation encoding="application/x-tex">x_{ij} = 1 \rightarrow u_i + q_i = u_j, \quad i,j \in A, j \ne 0, i \ne 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9456279999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>上面的约束表明只有在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_{ij} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>的情况下，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msub><mi>q</mi><mi>i</mi></msub><mo>=</mo><msub><mi>u</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">u_i + q_i = u_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>才成立，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">x,u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">u</span></span></span></span>是决策变量。<br>
Gurobi添加的约束如下（python）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.addConstrs((X[i,j] == <span class="number">1</span>) &gt;&gt; (Y[i] + demand[j] == Y[j]) <span class="keyword">for</span> i,j <span class="keyword">in</span> A <span class="keyword">if</span> i!=<span class="number">1</span> <span class="keyword">and</span> j!= <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>方法不止这一种，上述的是重载的形式，原来的形式应该使用<code>addGenConstrIndicator</code>这个方法，详见参考链接。</p>
<p>参考文章：<br>
<a target="_blank" rel="noopener" href="https://gurobi.com/documentation/current/refman/py_model_agc_indicator.html">https://gurobi.com/documentation/current/refman/py_model_agc_indicator.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/09/14/2024-09-14-gurobi-issue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/14/2024-09-14-gurobi-issue/" class="post-title-link" itemprop="url">Gurobi 11.02的一个数值问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-09-14 13:38:27 / 修改时间：14:26:15" itemprop="dateCreated datePublished" datetime="2024-09-14T13:38:27+08:00">2024-09-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近在写一个论文，审稿人让我增加一部分的实验内容，验证我启发式的性能。我选择和Gurobi进行对比。<br>
然后在我和Gurobi进行对比的过程中，<strong>发现某几个算例的启发式结果竟然比Gurobi的下界（gap=0）还低。</strong><br>
按道理来说，对于一个最小化的问题，上界是不可能比下界还低的，因此我怀疑是我的启发式算法有bug，最开始我是不相信Gurobi会有问题的。</p>
<p>复杂的验证过程以及漫长的Debug中，我发现自己的算法好像并没有什么问题，而且只有一两个算例出现了上述的情况。<br>
接着我发现如果我减少<code>FeasibilityTol</code>和<code>OptimalityTol</code>这两个参数（至最小值10e-9）以提升数值精度，那么情况有会有所改善，但是启发式的结果依旧比下界还低。</p>
<p>然后，我使用了一个常见的方法，强制决策变量等于启发式的解，把启发式的结果制作成约束添加进模型中，再求解发现Gurobi的结果竟然和我的启发式一致了，且gap等于0。这就出现了悖论：</p>
<ul>
<li>在那几个特殊的算例中（增加额外的约束gap=0，不增加约束也是gap=0），最小化问题增加额外的约束竟然使最优目标值更小了。</li>
</ul>
<p>这让我觉得太离谱了，增加额外约束最好的情况下也只能是和原问题的最优目标值一致。<br>
然后和Gurobi社区的工作人员拉扯了一个月，终于搞清楚了，Gurobi承认有bug，并且只能在下个版本修复了。</p>
<p>在此附上原帖子链接，纪念一下第一次为一个求解器厂商提出实质性bug。</p>
<p><a target="_blank" rel="noopener" href="https://support.gurobi.com/hc/en-us/community/posts/27254595262993-Add-additional-constraints-but-the-objective-decreased-in-minimize-problem">https://support.gurobi.com/hc/en-us/community/posts/27254595262993-Add-additional-constraints-but-the-objective-decreased-in-minimize-problem</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/09/03/2024-09-02-lagrange/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/03/2024-09-02-lagrange/" class="post-title-link" itemprop="url">拉格朗日松弛算法求解整数规划的基本原理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-03 14:16:15" itemprop="dateCreated datePublished" datetime="2024-09-03T14:16:15+08:00">2024-09-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-09-17 11:48:38" itemprop="dateModified" datetime="2024-09-17T11:48:38+08:00">2024-09-17</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>声明：</strong></p>
<ul>
<li>原文之前发表在本人的CSDN上，现搬运到博客里。</li>
<li>本文的目的是记录和分享学到的知识。作者已尽一切努力确保本文内容的准确性。作者在此声明不承担因本文中的错误或遗漏造成的任何损失所带来的责任，无论这些错误或遗漏是意外、疏忽或其他原因导致的。</li>
<li>转载请备注来源，欢迎<strong>点赞</strong>、<strong>收藏</strong>或指出本文不足。</li>
<li>版权声明：本文为博主原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接和本声明。</li>
<li>本文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45746917/article/details/125524606">https://blog.csdn.net/weixin_45746917/article/details/125524606</a></li>
</ul>
<p><strong>本文由作者用心整理，希望对您有所帮助。如果您入门或困扰于该问题，请您静下心来阅读，准备纸笔推导，一定会有所收获。所有例子和引证均带有来源，可点超链接深入了解。</strong></p>
<h1 id="概述"><a class="markdownIt-Anchor" href="#概述"></a> 概述</h1>
<p>  拉格朗日松弛是一种求解整数规划的、基于优化的启发式算法。该算法能提供较为优质的解，可证明解的质量（可得到优化上下界），但不保证最优性。拉格朗日松弛的应用十分广泛，例如无容量限制的设施选址问题（该问题为NP-hard问题）。<br>
  拉格朗日松弛算法可追溯到Everett 1963年，Fisher 1973使用了该算法求解了调度问题。注意，该算法并不是拉格朗日提出的，是借鉴了<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E6%95%B0%E6%B3%95/8550443?fromtitle=%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E5%AD%90%E6%B3%95&amp;fromid=1946079&amp;fr=aladdin">拉格朗日乘子法</a>的一些启示，由(<a target="_blank" rel="noopener" href="https://link.springer.com/chapter/10.1007/BFb0120690">Geoffrion 1974</a>)命名。</p>
<ul>
<li>
<p>松弛方法对于一个优化问题十分重要，因为这种方法为最优值提供了“上下界限”。</p>
</li>
<li>
<p>松弛就是把一个问题的约束<strong>变弱</strong>，这样可行域就大了，也能方便求解了。</p>
</li>
<li>
<p>最小化问题中，松弛问题的最优值是下界。最大化问题是上界。</p>
</li>
<li>
<p>松弛技术的精髓就是设计一个容易求解的松弛问题并得到一个优质的“界”。</p>
</li>
</ul>
<p>链接: <a target="_blank" rel="noopener" href="https://pubsonline.informs.org/doi/abs/10.1287/opre.11.3.399/">Everett 1963</a></p>
<p>链接: <a target="_blank" rel="noopener" href="https://pubsonline.informs.org/doi/abs/10.1287/opre.21.5.1114/">Fisher 1973</a></p>
<h2 id="从拉格朗日乘子法开始"><a class="markdownIt-Anchor" href="#从拉格朗日乘子法开始"></a> 从拉格朗日乘子法开始</h2>
<p>  微积分中，一类问题是求解一个函数的极大值或者极小值。当这个函数受限于另一个函数的时候，问题求解将变得困难。<strong>详见同济版《高等数学 下》（高等教育出版社）多元函数的极值及其求法——条件极值 拉格朗日乘数法。</strong></p>
<h3 id="维基百科的一个例子"><a class="markdownIt-Anchor" href="#维基百科的一个例子"></a> 维基百科的一个例子</h3>
<p>  参见<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E6%95%B0">维基百科</a>。<br>
  求函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>的极值，且要求满足条件<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">g(x,y)=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span>。<br>
  这里简单描述一下原理和证明过程，详细证明参见引用来源。假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>的取值为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">d_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，注意<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">d_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是随<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>的值变化的。只有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>d</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">f(x,y)=d_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">g(x,y)=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span>相切时，同时沿着有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>d</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">f(x,y)=d_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">g(x,y)=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span>的方向前进，在这种情况下，会出现极值。<br>
  由于二者是相切关系，那么二者的梯度满足如下关系：（切线、法线、梯度的关系）</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>λ</mi><mi mathvariant="normal">∇</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla f(x,y) = -\lambda \nabla (g(x,y)-c)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathnormal">λ</span><span class="mord">∇</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></span></p>
<p>于是，有</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mi>λ</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\nabla[f(x,y) + \lambda (g(x,y)-c)]=0\\
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span><span class="mspace newline"></span></span></span></span></p>
<p>  这样，如果求出了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">λ</span></span></span></span>的值，带到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mi>λ</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(x,y,\lambda)=f(x,y) + \lambda(g(x,y)-c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span>中，就能求出无约束条件下的极值和对应的极值点。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(x,y,\lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>在极值点处相等。极值点处，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\nabla F(x,y,\lambda)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>λ</mi></mrow></mfrac><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\frac{\partial F}{\partial \lambda}=g(x,y)-c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">λ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>c</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g(x,y)-c=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>​，所以极值点处有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(x,y,\lambda)=f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>。</p>
<h3 id="同济版第7版高等数学-下的例子"><a class="markdownIt-Anchor" href="#同济版第7版高等数学-下的例子"></a> 同济版第7版《高等数学 下》的例子</h3>
<p>  第九章p117给出了更详细的证明，这里直接给出结论：要找<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z=f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>在附加条件<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi (x,y)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>下的可能极值点，可做拉格朗日函数:</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mi>λ</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(x,y) = f(x,y) + \lambda \phi(x,y)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">λ</span></span></span></span>为参数，然后求<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span></span></span></span>对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">x,y,\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">λ</span></span></span></span>的一阶偏导，并令其为0，将这个三个等式联立。方程组求解得到的解<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>可能的极值点。</p>
<h1 id="整数规划拉格朗日松弛"><a class="markdownIt-Anchor" href="#整数规划拉格朗日松弛"></a> 整数规划拉格朗日松弛</h1>
<h2 id="问题构建"><a class="markdownIt-Anchor" href="#问题构建"></a> 问题构建</h2>
<p>  给定一个待求解的整数规划问题（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>）：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>Z</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>min</mi><mo>⁡</mo><mi>c</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext> s.t. </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>D</mi><mi>x</mi><mo>≤</mo><mi>e</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mo>≥</mo><mn>0</mn><mtext> and integral </mtext></mrow></mstyle></mtd></mtr></mtable><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mrow><mo fence="true">(</mo><mi mathvariant="normal">P</mi><mo fence="true">)</mo></mrow></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mrow><annotation encoding="application/x-tex">\begin{aligned}
Z=&amp; \min c x \\
\text { s.t. } &amp; A x=b \\
&amp; D x \leq e \\
&amp; x \geq 0 \text { and integral }
\end{aligned}
\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\left(\mathrm{P}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.7500000000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord"> s.t. </span></span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.9099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">b</span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">e</span></span></span><span style="top:-0.9099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord text"><span class="mord"> and integral </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathrm">P</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p>  我们松弛其整数约束，得到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">LP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>问题：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>Z</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>min</mi><mo>⁡</mo><mi>c</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext> s.t. </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>D</mi><mi>x</mi><mo>≤</mo><mi>e</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mrow><mo fence="true">(</mo><mrow><mi mathvariant="normal">L</mi><mi mathvariant="normal">P</mi></mrow><mo fence="true">)</mo></mrow></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mrow><annotation encoding="application/x-tex">\begin{aligned}
Z=&amp; \min c x \\
\text { s.t. } &amp; A x=b \\
&amp; D x \leq e \\
&amp; x \geq 0
\end{aligned}
\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\left(\mathrm{LP}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.7500000000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord"> s.t. </span></span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.9099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">b</span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">e</span></span></span><span style="top:-0.9099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathrm">L</span><span class="mord mathrm">P</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p>  我们松弛第一个等于约束，得到一个松弛后的拉格朗日问题（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）,其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>u</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>u</mi><mi>m</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">u=\{u_1,u_2,...u_m\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>是拉格朗日乘子。</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>min</mi><mo>⁡</mo><mi>c</mi><mi>x</mi><mo>+</mo><mi>u</mi><mo stretchy="false">(</mo><mi>A</mi><mi>x</mi><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext> s.t. </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>D</mi><mi>x</mi><mo>≤</mo><mi>e</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mo>≥</mo><mn>0</mn><mtext> and integral </mtext></mrow></mstyle></mtd></mtr></mtable><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mrow><mo fence="true">(</mo><mrow><mi mathvariant="normal">L</mi><msub><mi mathvariant="normal">R</mi><mi mathvariant="normal">u</mi></msub></mrow><mo fence="true">)</mo></mrow></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mrow><annotation encoding="application/x-tex">\begin{aligned}
Z_D(u)=&amp; \min c x + u(Ax-b) \\
\text { s.t. } &amp; D x \leq e \\
&amp; x \geq 0 \text { and integral }
\end{aligned}
\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\left(\mathrm{LR_u}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord"> s.t. </span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">e</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord text"><span class="mord"> and integral </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathrm">L</span><span class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p>  设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">x^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>问题的最优解，此时，有：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow><mtext> </mtext><mi>c</mi><mi>x</mi><mo>+</mo><mi>u</mi><mo stretchy="false">(</mo><mi>A</mi><mi>x</mi><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>c</mi><msup><mi>x</mi><mo>∗</mo></msup><mo>+</mo><mi>u</mi><mo stretchy="false">(</mo><mi>A</mi><msup><mi>x</mi><mo>∗</mo></msup><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><msup><mi>x</mi><mo>∗</mo></msup><mo>=</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z_D(u)= {\rm{min}}\,cx + u(Ax-b)\le cx^*+u(Ax^*-b) = cx^* = Z
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.75119em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.822026em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.738696em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></span></p>
<p>  这说明，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>的值一定小于等于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>的值。不等号的来源是松弛，因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>比<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>的约束更少，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的最优解一定小于等于把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">x^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>直接带入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>得到的目标函数值。由于在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msup><mi>x</mi><mo>∗</mo></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax^* =b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msup><mi>x</mi><mo>∗</mo></msup><mo>+</mo><mi>u</mi><mo stretchy="false">(</mo><mi>A</mi><msup><mi>x</mi><mo>∗</mo></msup><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><msup><mi>x</mi><mo>∗</mo></msup><mo>=</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">cx^*+u(Ax^*-b) = cx^* = Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.772026em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>。<br>
  如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>的约束变成了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax\le b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>，则需要求<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">u\ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>的约束变成了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>≥</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax\ge b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>，则需要求<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">u\le 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>。<br>
  总之，不管怎么样，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z_D(u)\le Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>在一定条件下成立，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>小于等于原问题的最优目标函数值。</p>
<h2 id="乘子u取值"><a class="markdownIt-Anchor" href="#乘子u取值"></a> 乘子<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>取值</h2>
<h3 id="拉格朗日对偶问题d"><a class="markdownIt-Anchor" href="#拉格朗日对偶问题d"></a> 拉格朗日对偶问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span></h3>
<p>   首先，应明确在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>的特定取值下，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>可以等于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>。此时，这个问题就变成了跟<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>相关的问题。如何给<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>取值，使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>尽可能取最大值以接近<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>的问题，称作拉格朗日对偶问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>，即：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo>=</mo><munder><mo><mi>max</mi><mo>⁡</mo></mo><mi>u</mi></munder><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(D)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">Z_D = \max _u Z_D(u) \tag{D}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.45em;vertical-align:-0.7em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43056em;"><span style="top:-2.4em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1.45em;vertical-align:-0.7em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">D</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p>该问题的决策变量是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>，目标函数是最大化<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>的值。也就是说，求解原问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>的最小化目标函数值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>已经转换成求解拉格朗日对偶问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>的目标函数值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>了。</p>
<p>   那么问题来了，拉格朗日对偶问题的形式很抽象，我们如何具象描述它呢？</p>
<h3 id="拉格朗日对偶重构问题bard"><a class="markdownIt-Anchor" href="#拉格朗日对偶重构问题bard"></a> 拉格朗日对偶重构问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span></h3>
<p>   假设拉格朗日松弛<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的可行解集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mi>x</mi><mo>≤</mo><mi>e</mi><mo separator="true">,</mo><mi>x</mi><mo>≥</mo><mn>0</mn><mtext> and integer</mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">X=\{x|Dx\le e ,x\ge 0 \text{ and integer}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord text"><span class="mord"> and integer</span></span><span class="mclose">}</span></span></span></span>是有限集，则我们可以令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">{</mo><msup><mi>x</mi><mi>t</mi></msup><mo separator="true">,</mo><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">X=\{x^t,t=1,...,T\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.043556em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">}</span></span></span></span>。</p>
<p>这样，问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>可重构为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>Z</mi><mi>D</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow><mtext> </mtext><mi>w</mi></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>s.t.</mtext><mspace width="1em"><mi>w</mi></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><mi>c</mi><msup><mi>x</mi><mi>t</mi></msup><mo>+</mo><mi>u</mi><mo stretchy="false">(</mo><mi>A</mi><msup><mi>x</mi><mi>t</mi></msup><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>T</mi></mrow></mstyle></mtd></mtr></mtable><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mrow><mo fence="true">(</mo><mover accent="true"><mi mathvariant="normal">D</mi><mo>ˉ</mo></mover><mo fence="true">)</mo></mrow></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mrow><annotation encoding="application/x-tex">\begin{aligned}
Z_D&amp;=\quad {\rm{max}}\,w\\
\text{s.t.}\quad w &amp;\le cx^t + u(Ax^t-b),t=1,...,T\\
\end{aligned}
\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\left(\mathrm{\bar{D}}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0035560000000006em;vertical-align:-1.2517780000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7517780000000003em;"><span style="top:-3.911778em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.408222em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2517780000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7517780000000003em;"><span style="top:-3.911778em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-2.408222em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2517780000000003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord mathrm">ˉ</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p>
<p><em>问：为什么可以这样重构?</em></p>
<p>*答：令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w=Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>，问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>想求<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>关于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>的最大值，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>的目标函数是求最大值。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>是最小化<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>x</mi><mo>+</mo><mi>u</mi><mo stretchy="false">(</mo><mi>A</mi><mi>x</mi><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c x + u(Ax-b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span>，那么<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>一定小于等于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的任意一个可行解<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>带入该表达式的值，即</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>min</mi><mo>⁡</mo><mi>c</mi><mi>x</mi><mo>+</mo><mi>u</mi><mo stretchy="false">(</mo><mi>A</mi><mi>x</mi><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>w</mi><mo>≤</mo><mi>c</mi><msup><mi>x</mi><mi>t</mi></msup><mo>+</mo><mi>u</mi><mo stretchy="false">(</mo><mi>A</mi><msup><mi>x</mi><mi>t</mi></msup><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min c x + u(Ax-b) = Z_D(u) = w \le cx^t + u(Ax^t-b)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75119em;vertical-align:-0.08333em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.926886em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.093556em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></p>
<p>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>问题的最优解时等号成立。*</p>
<h3 id="拉格朗日对偶重构问题的线性规划对偶barp"><a class="markdownIt-Anchor" href="#拉格朗日对偶重构问题的线性规划对偶barp"></a> 拉格朗日对偶重构问题的线性规划对偶<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span></h3>
<p>  这时，再求<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>的线性规划对偶<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>min</mi><mo>⁡</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>λ</mi><mi>t</mi></msub><mi>c</mi><msup><mi>x</mi><mi>t</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext> s.t. </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>λ</mi><mi>t</mi></msub><mi>A</mi><msup><mi>x</mi><mi>t</mi></msup><mo>=</mo><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>λ</mi><mi>t</mi></msub><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>λ</mi><mi>t</mi></msub><mo>≥</mo><mn>0</mn><mo separator="true">,</mo><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>T</mi></mrow></mstyle></mtd></mtr></mtable><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><mrow><mo fence="true">(</mo><mover accent="true"><mi mathvariant="normal">P</mi><mo>ˉ</mo></mover><mo fence="true">)</mo></mrow></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mspace></mrow><annotation encoding="application/x-tex">\begin{aligned}
Z_{D}=&amp; \min \sum_{t=1}^{T} \lambda_{t} c x^{t} \\
\text { s.t. } &amp; \sum_{t=1}^{T} \lambda_{t} A x^{t}=b \\
&amp; \sum_{t=1}^{T} \lambda_{t}=1 \\
&amp; \lambda_{t} \geq 0, t=1, \ldots, T
\end{aligned}
\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\left(\mathrm{\bar{P}}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:11.686347000000001em;vertical-align:-5.593173500000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.093173500000001em;"><span style="top:-8.0931735em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-4.6977245000000005em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord text"><span class="mord"> s.t. </span></span></span></span><span style="top:-1.3022755000000004em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"></span></span><span style="top:1.1048375000000004em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.593173500000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.093173500000001em;"><span style="top:-8.0931735em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-4.6977245000000005em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">b</span></span></span><span style="top:-1.3022755000000004em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:1.1048375000000004em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.593173500000001em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord mathrm">ˉ</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p>
<p>  对偶推导：从<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>向<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>推导，把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>分解成凸组合；从<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>向<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>推导，把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>看成<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>w</mi><mo>+</mo><mn>0</mn><mi>u</mi></mrow><annotation encoding="application/x-tex">1w+0u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord mathnormal">u</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>是无约束的决策变量。</p>
<p>  虽然<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">LP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>不是等价问题，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>并不是原问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>的线性松弛版本，但是当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是整数（0或1）时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>等价于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>。理由如下：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的可行解，一定满足约束<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>x</mi><mo>≤</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">Dx\le e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span></span></span></span>。既然满足了这个约束，在所有的可行解中，也肯定存在一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>满足<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msup><mi>x</mi><mi>t</mi></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax^t=b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>，那么令对应的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\lambda _t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>等于1即可。（满足条件a的所有解中，一定有一个解同时满足a和b，子集关系）</p>
<h3 id="拉格朗日对偶重构问题bard的意义"><a class="markdownIt-Anchor" href="#拉格朗日对偶重构问题bard的意义"></a> 拉格朗日对偶重构问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>的意义</h3>
<p>  问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>表明，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>是一系列线性函数的下限值。为了方便理解，假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>的变量数只有一个，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">T=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>表示对于问题<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>仅有4个可行解。那么，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>随<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>变化的图像如图所示：<br>
<img src="/2024/09/03/2024-09-02-lagrange/2024-09-03-14.22.57.png" alt="来源：Fisher: The Lagrangian Relaxation Method for Solving Integer Programming Problems  Management Science 50(12S), pp. 1861–1871, ©2004 INFORMS"></p>
<p>  在这个图中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>是已知的，是常数，那么得到了四个关于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>的线性函数。取这些函数在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>不同取值的最小值，即为函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>，如图中加粗线条所示。</p>
<p>  我们发现，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>是连续的，是凹函数（参照国际定义）。这样找最大值就很简单，比如，我们使用<strong>爬山算法</strong>，但是我们不能求导，因为最优点处不可导。</p>
<p>  既然不可导，那就用<strong>次梯度法</strong>。</p>
<h3 id="次梯度法"><a class="markdownIt-Anchor" href="#次梯度法"></a> 次梯度法</h3>
<h4 id="次梯度概念"><a class="markdownIt-Anchor" href="#次梯度概念"></a> 次梯度概念</h4>
<p>   满足如下公式的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>u</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.56778em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">u</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span> 处的次梯度。</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo stretchy="false">(</mo><mi>u</mi><mo>−</mo><mover accent="true"><mi>u</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mo>≥</mo><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">∀</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">y(u-\bar{u}) \ge Z_D(u) - Z_D(u), \forall u
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">u</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∀</span><span class="mord mathnormal">u</span></span></span></span></span></p>
<h4 id="次梯度性质"><a class="markdownIt-Anchor" href="#次梯度性质"></a> 次梯度性质</h4>
<ul>
<li>向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msup><mi>x</mi><mi>t</mi></msup><mo>−</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax^t-b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8768859999999999em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>求解 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>R</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">LR_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 对应位置的次梯度。其余的次梯度都是这些“基础”次梯度的凸组合。</li>
<li>当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">u^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>λ</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\lambda^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>是可行的且满足互补松弛定理时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">u^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>的最优解且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>λ</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\lambda^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>的最优解，这等价于当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">u^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 处的次梯度为0时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">u^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>的最优解。（说白了就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>取到了关于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>的最大值）</li>
</ul>
<h4 id="次梯度法更新乘子"><a class="markdownIt-Anchor" href="#次梯度法更新乘子"></a> 次梯度法更新乘子</h4>
<p>   给定一个初始的乘子值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">u^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span>，后续乘子第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>次迭代的值为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">u^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>，迭代公式如下：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>u</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>u</mi><mi>k</mi></msup><mo>+</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>A</mi><msup><mi>x</mi><mi>k</mi></msup><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">u^{k+1} = u^{k} + t_k(Ax^k-b)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9824379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">x^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>L</mi><msub><mi>R</mi><msup><mi>u</mi><mi>k</mi></msup></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(LR_{u^k})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.49738em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7820285714285713em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2026199999999999em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>的最优解，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">t_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是一个正数，称为迭代步长。</p>
<p>Goffin (1977)表明：</p>
<blockquote>
<p>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>k</mi></msub><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t_k→0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>k</mi></msubsup><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=0}^kt_i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2887179999999998em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><msup><mi>u</mi><mi>k</mi></msup><mo stretchy="false">)</mo><mo>→</mo><msub><mi>Z</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">Z_D(u^k)→Z_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p>
</blockquote>
<p>   常用的迭代步长公式为：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>t</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>λ</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msup><mi>Z</mi><mo>∗</mo></msup><mo>−</mo><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><msup><mi>u</mi><mi>k</mi></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>A</mi><msup><mi>x</mi><mi>k</mi></msup><mo>−</mo><mi>b</mi><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">t_k = \frac{\lambda_k(Z^*-Z_D(u^k))} {||Ax^k-b||^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.462108em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.526108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751079999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">(0,2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span></span></span></span>之间的标量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Z</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">Z^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">Z_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的上界，且使用启发式修改为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>的可行解。通常，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的初始值设置为2，当一定迭代次数后，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z_D(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>的值仍未增加，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的值减半。</p>
<p>   注意，这是一个经验性的方法，并不一定能满足最优收敛。</p>
<h1 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h1>
<p>上述的内容只是一个方法论，我们想求解一个问题，还是面临很多的困难的。具体的问题需要具体的分析，包含但不限于松弛哪个约束、获取上界的启发式方法、算法参数的调整等。具体的例子，可参考本人的硕士毕设（在github仓库中）使用拉格朗日松弛求解了一个选址问题。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/09/01/2024-09-01-subtour/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/01/2024-09-01-subtour/" class="post-title-link" itemprop="url">子回路消除方法及Gurobi实现</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-01 15:16:00" itemprop="dateCreated datePublished" datetime="2024-09-01T15:16:00+08:00">2024-09-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-09-17 11:25:05" itemprop="dateModified" datetime="2024-09-17T11:25:05+08:00">2024-09-17</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在读研一的时候第一次接触到子回路消除这个概念，今天特意写一下相关的内容，也算是一个心得与总结，以及一些我对于子回路消除的认知与理解。本文将从一个简单的TSP问题开始讲起，提出模型与消除方法，并使用求解器Gurobi实现各种子回路消除方法。</p>
<h1 id="什么是子回路"><a class="markdownIt-Anchor" href="#什么是子回路"></a> 什么是子回路？</h1>
<p>子回路是一个在TSP中和VRP中常见的现象，体现为一辆车走了两个或多个闭环路径。如果不知道VRP和TSP相关的问题与模型，建议补习相关内容。比如下面这张图的TSP问题。正常情况下，一个TSP问题的可行解应该如右图所示，即一辆车遍历所有节点。而左图中，很明显每个点被遍历了，但是竟然出现了两辆车。这显然不符合对于TSP问题的假设。然而在这种情况下（左图），两个回路竟然在数学公式上使用了同一辆车。这就是一个典型的子回路现象。</p>
<p><img src="/2024/09/01/2024-09-01-subtour/subtour.png" alt="subtours"></p>
<h1 id="为什么出现子回路"><a class="markdownIt-Anchor" href="#为什么出现子回路"></a> 为什么出现子回路</h1>
<p>简单来说，子回路的出现就是我们缺少一部分约束，导致没有完全地刻画问题中车辆的行为。我们知道车辆路径问题（vehicle routing problem, VRP）是旅行商问题（traveling salesman problem, TSP）问题的一个更加困难的版本，与其用一个VRP的例子作为教程，不如使用更为简单的TSP作为上手的开始。因为TSP过于经典，就不再过多赘述。简单来说就是如何以最短的距离不重复地走完地图上所有的城市并且回到出发点，其(不完整的)数学模型如下：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>min</mi><mo>⁡</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>N</mi></mrow></munder><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><mi>N</mi></mrow></munder><msub><mi>c</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\min \sum_{i\in N} \sum_{j\in N} c_{ij}x_{ij}  \tag{1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.480449em;vertical-align:-1.430444em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.430444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:2.480449em;vertical-align:-1.430444em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>N</mi></mrow></munder><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>N</mi></mrow></munder><msub><mi>x</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">∀</mi><mi>j</mi><mo>∈</mo><mi>N</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\sum_{i\in N} x_{ij} = \sum_{i\in N} x_{ji} = 1, \forall j \in N \tag{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3717110000000003em;vertical-align:-1.321706em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3717110000000003em;vertical-align:-1.321706em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="tag"><span class="strut" style="height:2.3717110000000003em;vertical-align:-1.321706em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo><mo separator="true">,</mo><mi mathvariant="normal">∀</mi><mi>i</mi><mo>∈</mo><mi>N</mi><mo separator="true">,</mo><mi>j</mi><mo>∈</mo><mi>N</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">x_{ij} \in \{0,1\}, \forall i \in N, j\in N \tag{3}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252079999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∀</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="tag"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p>上述公式使用了常见的符号集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>是节点集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>是弧长。公式(2)表示每个点的入度等于出度，即流平衡。<br>
公式(3)是0-1决策变量。</p>
<p>我们观察上面的图的左侧子图，每个点的入度也确实等于出度。也就是说上述的模型是不完整的，我们没有消除子回路的约束。</p>
<h1 id="消除子回路"><a class="markdownIt-Anchor" href="#消除子回路"></a> 消除子回路</h1>
<p>如上所述，我们需要增加一些约束，这些约束帮助我们消除子回路。这些约束都相当精彩，在领悟其中的原理之后拍手叫绝。</p>
<h2 id="dfj方法"><a class="markdownIt-Anchor" href="#dfj方法"></a> DFJ方法</h2>
<p>Dantzig-Fulkerson-Johnson 简称 DFJ 方法是消除子回路的经典方法，公式如下：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>S</mi></mrow></munder><munder><mo>∑</mo><mrow><mi>j</mi><mo mathvariant="normal">∉</mo><mi>S</mi></mrow></munder><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≥</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">∀</mi><mi>S</mi><mo>⊂</mo><mi>N</mi><mo separator="true">,</mo><mi>S</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">\sum_{i\in S} \sum_{j \notin S} x_{ij} \ge 1, \forall S \subset N, S \ne \emptyset 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5660100000000003em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mord mtight"><span class="mrel mtight">∈</span></span><span class="mord vbox mtight"><span class="thinbox mtight"><span class="llap mtight"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord mtight"><span class="mord mtight">/</span><span class="mspace mtight" style="margin-right:0.06505555555555556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">∅</span></span></span></span></span></p>
<p>DFJ约束规定一个节点集合<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>的非空子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>，要求连接<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>外面的点和在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>内部的点的弧的数量大于等于1。换句话说，对于任意一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>的子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>，一定有一条弧离开<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>。反之，如果存在一个子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>，没有一条弧能够离开<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>，那就说明<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>存在子回路。</p>
<p>DFJ约束很简单也很直观，但是问题是约束的数量不是多项式级的，我们不太可能把一个大规模问题的所有的约束枚举出来。</p>
<h2 id="mtz方法"><a class="markdownIt-Anchor" href="#mtz方法"></a> MTZ方法</h2>
<p>Miller, Tucker, and Zemlin 简称 MTZ 方法也是消除子回路的经典方法，公式如下：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>≤</mo><mi>M</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">∀</mi><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>∈</mo><mi>N</mi><mo separator="true">,</mo><mi>i</mi><mo mathvariant="normal">≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">t_i-t_j+1\leq M(1-x_{ij}), \forall i,j\in N,i\neq j
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∀</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>t</mi><mi>i</mi></msub><mo>≤</mo><mi mathvariant="normal">∣</mi><mi>N</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">∀</mi><mi>i</mi><mo>∈</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">0 \le t_i \le |N|-1, \forall i\in N
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∀</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span></p>
<p>MTZ方法引入了一个新的变量，这个变量没有任何物理意义。MTZ公式可以这样理解：<br>
首先，如果两个点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>之间存在一个弧<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>，那么两个点之间将会产生一个前后关系<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>先被访问，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>后被访问。这个前后关系我们先假设为时间，也就是说访问<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>的时间一定比访问<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>的时间小。或者我们假设一个计数器，每经过一个点计数器增加一个单位。这个量（计数器、时间）并不存在于定义的TSP问题的物理含义中，可以解释成任意一种能够被人理解的东西（时间、计数器、容量变化…）。现在，我们用额外的决策变量代表每个点被访问的前后顺序，然后让这些值相互关联起来，就能产生前后顺序进而消除子回路。</p>
<p>这个额外的决策变量就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo separator="true">,</mo><mi mathvariant="normal">∀</mi><mi>i</mi><mo>∈</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">t_i, \forall i \in N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∀</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>，那么按照我们上述的计数器假设，如果点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>之后被访问（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_{ij}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>），那么一定有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub><mo>≥</mo><msub><mi>t</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t_j \ge t_i + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.922078em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>。如果这种关系（点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>之后被访问）不存在，那么<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub><mo>≥</mo><msub><mi>t</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t_j \ge t_i + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.922078em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>的关系也不存在了，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>随意取值。我们就得到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>≤</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">t_i-t_j+1\leq M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>是一个足够大的数。这样就得到了上述的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>≤</mo><mi>M</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">∀</mi><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>∈</mo><mi>N</mi><mo separator="true">,</mo><mi>i</mi><mo mathvariant="normal">≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">t_i-t_j+1\leq M(1-x_{ij}), \forall i,j\in N,i\neq j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∀</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>的基础原理，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>最小取值为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>N</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|N|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord">∣</span></span></span></span>。</p>
<p>如果存在一个子回路，那<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的关系是不可能成立的，因为会无限绕圈，使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>的关系总是不能被满足。</p>
<h2 id="其他方法"><a class="markdownIt-Anchor" href="#其他方法"></a> 其他方法</h2>
<p>在介绍了上述的两个经典的方法之后，以下是一个综述文章，介绍了各种TSP子回路消除方法。感兴趣自己看，这里就不复现了。</p>
<p>A comparative analysis of several asymmetric traveling salesman problem formulations,<br>
Computers &amp; Operations Research, 2009</p>
<h1 id="gurobi-实现mtz和dfj子回路消除"><a class="markdownIt-Anchor" href="#gurobi-实现mtz和dfj子回路消除"></a> Gurobi 实现MTZ和DFJ子回路消除</h1>
<p>上述介绍中已经提到DFJ方法的约束个数是有限的，但是指数级的。我们不太可能用求解器把所有子回路的情况都考虑进去。首先声明这是一个简单的代码，用了20分钟写的简单例子，没有面向对象。</p>
<p>那么 talk is cheap, show me your code。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gurobipy <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br></pre></td></tr></table></figure>
<p><code>extract_numbers()</code>从<code>[a,b]</code>这样的方括号中提取<code>a</code>和<code>b</code>这两个数字，并返回一个<code>list</code>，用于从变量名中提取索引。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">extract_numbers</span>(<span class="params">s</span>):  <span class="comment"># 使用正则表达式匹配方括号中的两个数字</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(<span class="string">r&quot;\[(\d+),(\d+)\]&quot;</span>, s)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        <span class="comment"># 提取匹配到的数字并转换为整数</span></span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">1</span>)), <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">2</span>))]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<p><code>get_tour()</code>函数从一个字典<code>edges</code>中获得一个回路。字典<code>edges</code>的一个键值对是一条弧，键是起点，值是终点。<br>
例如<code>edges=&#123;1:2, 3:4, 2:3, 4:1&#125;</code>，则得到<code>tour=[1,2,3,4]</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_tour</span>(<span class="params">edges: <span class="built_in">dict</span></span>):</span><br><span class="line">    tour = []  <span class="comment"># 一个回路</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(tour) == <span class="number">0</span>:  <span class="comment"># 空的回路</span></span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> edges:  <span class="comment"># 包含起点，则以起点开始</span></span><br><span class="line">                tour.append(<span class="number">0</span>)</span><br><span class="line">                tour.append(edges[<span class="number">0</span>])</span><br><span class="line">                <span class="keyword">del</span> edges[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:  <span class="comment"># 不包含起点，则以第一个点开始</span></span><br><span class="line">                tmp = <span class="built_in">list</span>(edges.keys())</span><br><span class="line">                tour.append(tmp[<span class="number">0</span>])</span><br><span class="line">                tour.append(edges[tmp[<span class="number">0</span>]])</span><br><span class="line">                <span class="keyword">del</span> edges[tmp[<span class="number">0</span>]]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp = edges.get(tour[-<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> tmp == <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">break</span>  <span class="comment"># 产生了一个回路</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tour.append(tmp)</span><br><span class="line">                <span class="keyword">del</span> edges[tour[-<span class="number">2</span>]]</span><br><span class="line">    <span class="keyword">return</span> edges, tour[:-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p><code>mycallback</code>函数为DFJ的约束添加过程，由于这样的约束数量很多无法一次添加，那么使用<code>callback</code>函数进行添加。<br>
在<code>MIPSOL</code>处（mip solution）如果发现了一个带子回路的解，则添加针对这个回路的DFJ约束。注意，我们假设TSP的起点一定不在子回路里面，也就是只有不带起点的回路才是子回路。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mycallback</span>(<span class="params">model, where</span>):</span><br><span class="line">    <span class="keyword">if</span> where == gp.GRB.Callback.MIPSOL:</span><br><span class="line">        <span class="comment"># 解析获得的解</span></span><br><span class="line">        var_val = model.cbGetSolution(model._var)</span><br><span class="line"></span><br><span class="line">        edges = &#123;&#125;  <span class="comment"># TSP 决定走的边</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(var_val)):</span><br><span class="line">            <span class="keyword">if</span> var_val[i] &gt; <span class="number">0.5</span>:</span><br><span class="line">                tmp = extract_numbers(model._var[i].VarName)</span><br><span class="line">                edges.update(&#123;tmp[<span class="number">0</span>]: tmp[<span class="number">1</span>]&#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 在edges搜索一个子回路，要求起点一定不在子回路里面</span></span><br><span class="line">        flag_subtour = <span class="literal">False</span></span><br><span class="line">        edges, tour = get_tour(edges)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(tour) &lt; model._node_num:  <span class="comment"># 一定存在子回路</span></span><br><span class="line">            flag_subtour = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 针对这个子回路添加 DFJ约束</span></span><br><span class="line">        <span class="keyword">if</span> flag_subtour:</span><br><span class="line">            edges, tour = get_tour(edges)  <span class="comment"># 可能有多个subtour，获得一个子回路即可</span></span><br><span class="line">            <span class="keyword">assert</span> <span class="built_in">len</span>(tour) &lt; model._node_num</span><br><span class="line">            <span class="comment"># 加约束</span></span><br><span class="line">            pairs = [(i, j) <span class="keyword">for</span> i <span class="keyword">in</span> tour <span class="keyword">for</span> j <span class="keyword">in</span> tour <span class="keyword">if</span> i != j]</span><br><span class="line">            lexp = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> pairs:</span><br><span class="line">                lexp += model.getVarByName(<span class="string">&quot;x[&quot;</span> + <span class="built_in">str</span>(p[<span class="number">0</span>]) + <span class="string">&quot;,&quot;</span> + <span class="built_in">str</span>(p[<span class="number">1</span>]) + <span class="string">&quot;]&quot;</span>)</span><br><span class="line">            model.cbLazy(lexp &lt;= <span class="built_in">len</span>(tour) - <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>使用DFJ方法的模型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_tsp_dfj</span>(<span class="params">nodes, distances</span>):</span><br><span class="line">    <span class="comment"># TSP 求解</span></span><br><span class="line">    model = gp.Model()</span><br><span class="line">    x = model.addVars(</span><br><span class="line">        distances.keys(), obj=distances, vtype=gp.GRB.BINARY, name=<span class="string">&quot;x&quot;</span></span><br><span class="line">    )  <span class="comment"># 变量</span></span><br><span class="line"></span><br><span class="line">    model.addConstrs(gp.quicksum(x[i, j] <span class="keyword">for</span> j <span class="keyword">in</span> nodes <span class="keyword">if</span> i != j) == <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> nodes)</span><br><span class="line">    model.addConstrs(gp.quicksum(x[j, i] <span class="keyword">for</span> j <span class="keyword">in</span> nodes <span class="keyword">if</span> i != j) == <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> nodes)</span><br><span class="line"></span><br><span class="line">    model.update()</span><br><span class="line">    model._var = model.getVars()</span><br><span class="line">    model._node_num = <span class="built_in">len</span>(nodes)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用LazyConstraints声明</span></span><br><span class="line">    model.Params.LazyConstraints = <span class="number">1</span></span><br><span class="line">    model.optimize(mycallback)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> model.Status == gp.GRB.OPTIMAL:</span><br><span class="line">        edges = &#123;&#125;  <span class="comment"># 被选中的边</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(model._var)):</span><br><span class="line">            <span class="keyword">if</span> model._var[i].X &gt; <span class="number">0.5</span>:</span><br><span class="line">                tmp = extract_numbers(model._var[i].VarName)</span><br><span class="line">                edges.update(&#123;tmp[<span class="number">0</span>]: tmp[<span class="number">1</span>]&#125;)</span><br><span class="line">        edges, tour = get_tour(edges)</span><br><span class="line">        <span class="built_in">print</span>(tour)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;路径中点的个数：<span class="subst">&#123;<span class="built_in">len</span>(tour)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;路径长度：<span class="subst">&#123;model.ObjVal&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>使用MTZ方法的模型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_tsp_mtz</span>(<span class="params">nodes, distances</span>):</span><br><span class="line">    <span class="comment"># TSP 求解</span></span><br><span class="line">    model = gp.Model()</span><br><span class="line">    x = model.addVars(</span><br><span class="line">        distances.keys(), obj=distances, vtype=gp.GRB.BINARY, name=<span class="string">&quot;x&quot;</span></span><br><span class="line">    )  <span class="comment"># 变量</span></span><br><span class="line">    t = model.addVars((i <span class="keyword">for</span> i <span class="keyword">in</span> nodes), vtype=gp.GRB.CONTINUOUS, name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    model.addConstrs(gp.quicksum(x[i, j] <span class="keyword">for</span> j <span class="keyword">in</span> nodes <span class="keyword">if</span> i != j) == <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> nodes)</span><br><span class="line">    model.addConstrs(gp.quicksum(x[j, i] <span class="keyword">for</span> j <span class="keyword">in</span> nodes <span class="keyword">if</span> i != j) == <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> nodes)</span><br><span class="line">    <span class="comment"># model.addConstr(t[0] == 0)</span></span><br><span class="line">    node_without_starts = copy.deepcopy(nodes)</span><br><span class="line">    node_without_starts.remove(<span class="number">0</span>)</span><br><span class="line">    model.addConstrs(</span><br><span class="line">        t[i] - t[j] + <span class="number">1</span> &lt;= <span class="built_in">len</span>(nodes) * (<span class="number">1</span> - x[(i, j)])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> node_without_starts</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> node_without_starts</span><br><span class="line">        <span class="keyword">if</span> i != j</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    model.update()</span><br><span class="line">    model._node_num = <span class="built_in">len</span>(nodes)</span><br><span class="line"></span><br><span class="line">    model.optimize()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> model.Status == gp.GRB.OPTIMAL:</span><br><span class="line">        edges = &#123;&#125;  <span class="comment"># 被选中的边</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> nodes:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> nodes:</span><br><span class="line">                <span class="keyword">if</span> i != j:</span><br><span class="line">                    <span class="keyword">if</span> model.getVarByName(<span class="string">&quot;x[&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;,&quot;</span> + <span class="built_in">str</span>(j) + <span class="string">&quot;]&quot;</span>).X &gt; <span class="number">0.5</span>:</span><br><span class="line">                        edges.update(&#123;i:j&#125;)</span><br><span class="line">        edges, tour = get_tour(edges)</span><br><span class="line">        <span class="built_in">print</span>(tour)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;路径中点的个数：<span class="subst">&#123;<span class="built_in">len</span>(tour)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;路径长度：<span class="subst">&#123;model.ObjVal&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>主程序生成一个50个点的TSP问题，同一个问题使用两种方法求解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    npoints = <span class="built_in">int</span>(<span class="number">50</span>)</span><br><span class="line">    seed = <span class="built_in">int</span>(<span class="number">41372890</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个随机的TSP算例</span></span><br><span class="line">    random.seed(seed)</span><br><span class="line">    nodes = <span class="built_in">list</span>(<span class="built_in">range</span>(npoints))</span><br><span class="line">    points = [(random.randint(<span class="number">0</span>, <span class="number">100</span>), random.randint(<span class="number">0</span>, <span class="number">100</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> nodes]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 欧式距离</span></span><br><span class="line">    distances = &#123;</span><br><span class="line">        (i, j): math.sqrt(<span class="built_in">sum</span>((points[i][k] - points[j][k]) ** <span class="number">2</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)))</span><br><span class="line">        <span class="keyword">for</span> i, j <span class="keyword">in</span> combinations(nodes, <span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> combinations(nodes, <span class="number">2</span>):</span><br><span class="line">        distances.update(&#123;(j, i): distances[(i, j)]&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 算法求解</span></span><br><span class="line">    solve_tsp_dfj(nodes, distances)</span><br><span class="line">    solve_tsp_mtz(nodes, distances)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/08/24/2024-08-24-elsarticle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/08/24/2024-08-24-elsarticle/" class="post-title-link" itemprop="url">爱思唯尔期刊Latex模板elsarticle使用心得经验</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-08-24 21:07:00" itemprop="dateCreated datePublished" datetime="2024-08-24T21:07:00+08:00">2024-08-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-09-06 18:11:59" itemprop="dateModified" datetime="2024-09-06T18:11:59+08:00">2024-09-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>LaTex是科研写作中常见的排版工具。爱思唯尔期刊提供了Latex模板，使用该模板可简化在投稿过程中关于稿件的排版过程，在编译过后就能得到期刊认可的排版格式。</p>
<p>不少期刊都已经采用了“Your paper your way”的投稿方式，即根据作者的喜好的排版方式提交稿件，在接收后排版成期刊的要求的格式即可，但也提供了Latex模板。<br>
关于爱思唯尔期刊的Latex模板，详见<a target="_blank" rel="noopener" href="https://www.elsevier.com/researcher/author/policies-and-guidelines/latex-instructions">https://www.elsevier.com/researcher/author/policies-and-guidelines/latex-instructions</a></p>
<p>尽管<strong>内容大于形式，红楼梦手抄一万遍也是经典，我的博客打印出来也只是我的博客</strong>，<br>
但我们使用Latex模板将给审稿人表达一种专业且认真的态度，也可以简化写作、排版、公式输入及编号、交叉引用的流程。</p>
<p>请注意：<u>阅读本文需要一定Latex使用经验，且本文只针对爱思唯尔期刊Latex模板elsarticle有效。</u></p>
<h1 id="1-使用的宏包介绍"><a class="markdownIt-Anchor" href="#1-使用的宏包介绍"></a> 1. 使用的宏包介绍</h1>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% \usepackage[numbers]&#123;natbib&#125;</span></span><br><span class="line"><span class="comment">% \usepackage[authoryear,longnamesfirst]&#123;natbib&#125;</span></span><br><span class="line"><span class="keyword">\usepackage</span>[authoryear]&#123;natbib&#125;</span><br></pre></td></tr></table></figure>
<p>该宏包是elsarticle自带的引用格式的宏包，一般我选择使用第三个<code>[authoryear]</code>参数。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;lineno&#125;</span><br></pre></td></tr></table></figure>
<p><code>lineno</code>是行号宏包，投稿时如需加行号则使用此宏包。<br>
然而，该宏包对于模板的双列布局可用，但是支持性一般。<br>
此外<strong>不推荐使用双列模板</strong>，除非没有长公式或者长图、长表等等，<br>
elsarticle的双列模板虽然好看，但是给排版（尤其是跨列图、表、公式）带来诸多困难。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;threeparttable&#125; </span><br></pre></td></tr></table></figure>
<p><code>threeparttable</code>可以实现表格以及表格下方的注释，十分好用。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>[ruled,linesnumbered]&#123;algorithm2e&#125; </span><br></pre></td></tr></table></figure>
<p><code>algorithm2e</code>是算法伪代码的常用宏包。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;subcaption&#125;</span><br></pre></td></tr></table></figure>
<p><code>subcaption</code> 可以实现子图</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125; </span><br></pre></td></tr></table></figure>
<p><code>cleveref</code> 实现交叉引用带label名字，比如<code>Section 1</code>, 而不是使用<code>\ref</code>仅引用一个数字。<br>
<strong>该宏包最好放在所有宏包命令的最后</strong></p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;pdflscape&#125; <span class="comment">% 单页横置</span></span><br></pre></td></tr></table></figure>
<p><code>pdflscape</code>是某页横置的包，支持pdf旋转，比<code>landscape</code>更好一些。<br>
<code>landscape</code>编译出来后，pdf内容是横置的，但是页面仍是竖置，而<code>pdflscape</code>的页面也是横置的。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;midpage&#125; <span class="comment">% 页面垂直居中内容</span></span><br></pre></td></tr></table></figure>
<p><code>midpage</code>配合<code>pdflscape</code>使用，可以使用横置的内容位于页面的垂直方向的中心（垂直居中）。<br>
再配合横向居中<code>\centering</code>使用，就是页面的正中心。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;afterpage&#125; <span class="comment">% 减少横向排版某页前后的空白页</span></span><br></pre></td></tr></table></figure>
<p><code>afterpage</code>配合<code>pdflscape</code>使用，可避免<code>pdflscape</code>使用前后文章出现大面积空白（因为<code>pdflscape</code>在哪里使用就在哪里分页）。</p>
<h1 id="2-实践例子"><a class="markdownIt-Anchor" href="#2-实践例子"></a> 2. 实践例子</h1>
<p>Minimal Working Example (MWE) 是Latex是一个精简到最小长度的.tex文件。是一个可以运行的，最简短的tex文件。<br>
以下例子均基于<code>MWE</code>或者elsarticle的<code>cas-sc-sample.tex</code>文件进行展示。<br>
文本填充使用了<code>lipsum</code>宏包生成随机文本</p>
<h2 id="行号-lineno"><a class="markdownIt-Anchor" href="#行号-lineno"></a> 行号 <code>lineno</code></h2>
<p>展示行号使用了lineno宏包，代码如下：</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;lipsum&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;lineno&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\let</span><span class="keyword">\WriteBookmarks</span><span class="keyword">\relax</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\floatpagepagefraction</span>&#123;1&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\textpagefraction</span>&#123;.001&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class="line"><span class="keyword">\author</span>[1]&#123;Name&#125;[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;abstract&#125;</span><br><span class="line">  Null.</span><br><span class="line"><span class="keyword">\end</span>&#123;abstract&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;keywords&#125;</span><br><span class="line">  Null</span><br><span class="line"><span class="keyword">\end</span>&#123;keywords&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\maketitle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\linenumbers</span></span><br><span class="line"><span class="keyword">\section</span>&#123;Introduction&#125;</span><br><span class="line"><span class="keyword">\lipsum</span>[1]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><code>\linenumbers</code>命令放在节标题前面就可以生成行号了，结果如下：</p>
<p><img src="/2024/08/24/2024-08-24-elsarticle/2024-08-27-14-21-28.png" alt="行号生成"></p>
<h2 id="表格注释threeparttable"><a class="markdownIt-Anchor" href="#表格注释threeparttable"></a> 表格注释<code>threeparttable</code></h2>
<p>在表格展示结果的过程中总会有需要在表格下方注释的情况，使用<code>threeparttable</code>宏包可满足该需求。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;lipsum&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;threeparttable&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\let</span><span class="keyword">\WriteBookmarks</span><span class="keyword">\relax</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\floatpagepagefraction</span>&#123;1&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\textpagefraction</span>&#123;.001&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class="line"><span class="keyword">\author</span>[1]&#123;Name&#125;[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;abstract&#125;</span><br><span class="line">  Null.</span><br><span class="line"><span class="keyword">\end</span>&#123;abstract&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;keywords&#125;</span><br><span class="line">  Null</span><br><span class="line"><span class="keyword">\end</span>&#123;keywords&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\maketitle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Introduction&#125;</span><br><span class="line"><span class="keyword">\lipsum</span>[1]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;table&#125;[width=0.4<span class="keyword">\textwidth</span>, pos=thb]</span><br><span class="line"><span class="keyword">\scriptsize</span></span><br><span class="line"><span class="keyword">\tabcolsep</span>=2.5pt</span><br><span class="line"><span class="keyword">\renewcommand</span><span class="keyword">\arraystretch</span>&#123;1.5&#125;</span><br><span class="line"><span class="keyword">\centering</span></span><br><span class="line"><span class="keyword">\caption</span>&#123;Table notes&#125;</span><br><span class="line"><span class="keyword">\label</span>&#123;tb:review&#125;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;threeparttable&#125;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;tabular*&#125;&#123;<span class="keyword">\tblwidth</span>&#125;&#123;lcclccl&#125;</span><br><span class="line">    <span class="keyword">\toprule</span></span><br><span class="line">    Ref. <span class="built_in">&amp;</span> <span class="keyword">\multicolumn</span>&#123;2&#125;&#123;c&#125;&#123;Omnichannel concept&#125; <span class="built_in">&amp;</span> <span class="keyword">\multicolumn</span>&#123;2&#125;&#123;l&#125;&#123;Customer&#125; <span class="built_in">&amp;</span> <span class="keyword">\multicolumn</span>&#123;1&#125;&#123;l&#125;&#123;Store&#125;  <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\midrule</span></span><br><span class="line">    O<span class="keyword">\tnote</span>&#123;a&#125; <span class="built_in">&amp;</span> F  <span class="built_in">&amp;</span> S <span class="built_in">&amp;</span> M  <span class="built_in">&amp;</span> P <span class="built_in">&amp;</span> S  <span class="built_in">&amp;</span> L,C   <span class="keyword">\\</span></span><br><span class="line">    C <span class="built_in">&amp;</span> R  <span class="built_in">&amp;</span> S <span class="built_in">&amp;</span> M<span class="keyword">\tnote</span>&#123;*&#125;  <span class="built_in">&amp;</span> C <span class="built_in">&amp;</span> H  <span class="built_in">&amp;</span> L,R   <span class="keyword">\\</span></span><br><span class="line">    O <span class="built_in">&amp;</span> R  <span class="built_in">&amp;</span> S <span class="built_in">&amp;</span> M  <span class="built_in">&amp;</span> C <span class="built_in">&amp;</span> H  <span class="built_in">&amp;</span> L,R<span class="keyword">\tnote</span>&#123;<span class="built_in">$</span><span class="keyword">\dagger</span><span class="built_in">$</span>&#125; <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\bottomrule</span></span><br><span class="line">  <span class="keyword">\end</span>&#123;tabular*&#125;<span class="comment">%</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">\begin</span>&#123;tablenotes&#125;</span><br><span class="line">    <span class="keyword">\scriptsize</span></span><br><span class="line">    <span class="keyword">\item</span>[a] table note a </span><br><span class="line">    <span class="keyword">\item</span>[*] asterisk</span><br><span class="line">    <span class="keyword">\item</span>[<span class="built_in">$</span><span class="keyword">\dagger</span><span class="built_in">$</span>] dagger</span><br><span class="line">  <span class="keyword">\end</span>&#123;tablenotes&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;threeparttable&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;table&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>这会生成一个带有注释的表格。</p>
<p><img src="/2024/08/24/2024-08-24-elsarticle/tablenote.png" alt="表格注释"></p>
<h2 id="伪代码"><a class="markdownIt-Anchor" href="#伪代码"></a> 伪代码</h2>
<p>请参考Overleaf的伪代码包，写的非常详细。<br>
<a target="_blank" rel="noopener" href="https://www.overleaf.com/learn/latex/Algorithms">https://www.overleaf.com/learn/latex/Algorithms</a></p>
<h2 id="子图-subcaption"><a class="markdownIt-Anchor" href="#子图-subcaption"></a> 子图 <code>subcaption</code></h2>
<p>使用子图，只需要引用<code>subcaption</code>宏包即可，子图换行使用<code>\\</code>即可。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;lipsum&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;subcaption&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\let</span><span class="keyword">\WriteBookmarks</span><span class="keyword">\relax</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\floatpagepagefraction</span>&#123;1&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\textpagefraction</span>&#123;.001&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class="line"><span class="keyword">\author</span>[1]&#123;Name&#125;[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;abstract&#125;</span><br><span class="line">  Null.</span><br><span class="line"><span class="keyword">\end</span>&#123;abstract&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;keywords&#125;</span><br><span class="line">  Null</span><br><span class="line"><span class="keyword">\end</span>&#123;keywords&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\maketitle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Introduction&#125;</span><br><span class="line"><span class="keyword">\lipsum</span>[1]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class="line">  <span class="keyword">\centering</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 1&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:routes&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\hfill</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 2&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:cycle&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\hfill</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 3&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:aggregate&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 4&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:assign&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\hspace</span>&#123;0.15<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 5&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:newroute&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\caption</span>&#123;<span class="keyword">\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;figure&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>这会生成一个两行子图，第一行有3张，第二行有2张。<br>
<img src="/2024/08/24/2024-08-24-elsarticle/subfigure.png" alt="子图生成"></p>
<h2 id="交叉引用-cleveref"><a class="markdownIt-Anchor" href="#交叉引用-cleveref"></a> 交叉引用 <code>cleveref</code></h2>
<p>交叉引用是Latex一个重要的功能，自带的<code>\ref</code>功能只能引用数字，生成出来的效果并不好看，比如“Section <span style="color:blue;">1.1 </span>”, 而不是期刊常见的“<span style="color:blue;">Section 1.1 </span>”。使用<code>cleveref</code>宏包解决这个问题。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;lipsum&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;subcaption&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\let</span><span class="keyword">\WriteBookmarks</span><span class="keyword">\relax</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\floatpagepagefraction</span>&#123;1&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\textpagefraction</span>&#123;.001&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class="line"><span class="keyword">\author</span>[1]&#123;Name&#125;[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;abstract&#125;</span><br><span class="line">  Null.</span><br><span class="line"><span class="keyword">\end</span>&#123;abstract&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;keywords&#125;</span><br><span class="line">  Null</span><br><span class="line"><span class="keyword">\end</span>&#123;keywords&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\maketitle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Introduction&#125;</span><br><span class="line"><span class="keyword">\Cref</span>&#123;subfig:assign&#125; is in <span class="keyword">\Cref</span>&#123;fig:aggr&#125;. </span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class="line">  <span class="keyword">\centering</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 1&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:routes&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\hfill</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 2&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:cycle&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\hfill</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 3&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:aggregate&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 4&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:assign&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\hspace</span>&#123;0.15<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;subfigure 5&#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;subfig:newroute&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">  <span class="keyword">\caption</span>&#123;<span class="keyword">\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;figure&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>这会生成一个带引用类型的交叉引用格式。<br>
<img src="/2024/08/24/2024-08-24-elsarticle/cleveref.png" alt="交叉引用"></p>
<h2 id="横置某页-pdflscape-midpage-afterpage"><a class="markdownIt-Anchor" href="#横置某页-pdflscape-midpage-afterpage"></a> 横置某页 <code>pdflscape</code> <code>midpage</code> <code>afterpage</code></h2>
<p>横置一个pdf页码可以解决某个表格或者图太长的问题，使用<code>pdflscape</code>可以将某一页横置，以放下这些图表。<br>
基础使用方法如下：</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;lipsum&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;subcaption&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;pdflscape&#125; </span><br><span class="line"><span class="keyword">\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\let</span><span class="keyword">\WriteBookmarks</span><span class="keyword">\relax</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\floatpagepagefraction</span>&#123;1&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\textpagefraction</span>&#123;.001&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class="line"><span class="keyword">\author</span>[1]&#123;Name&#125;[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;abstract&#125;</span><br><span class="line">  Null.</span><br><span class="line"><span class="keyword">\end</span>&#123;abstract&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;keywords&#125;</span><br><span class="line">  Null</span><br><span class="line"><span class="keyword">\end</span>&#123;keywords&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\maketitle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Introduction&#125;</span><br><span class="line"><span class="keyword">\Cref</span>&#123;subfig:assign&#125; is in <span class="keyword">\Cref</span>&#123;fig:aggr&#125;. </span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;landscape&#125;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class="line">    <span class="keyword">\centering</span></span><br><span class="line">    <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">      <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">      <span class="keyword">\caption</span>&#123;subfigure 1&#125;</span><br><span class="line">      <span class="keyword">\label</span>&#123;subfig:routes&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">    <span class="keyword">\hfill</span></span><br><span class="line">    <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">      <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">      <span class="keyword">\caption</span>&#123;subfigure 2&#125;</span><br><span class="line">      <span class="keyword">\label</span>&#123;subfig:cycle&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">    <span class="keyword">\hfill</span></span><br><span class="line">    <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">      <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">      <span class="keyword">\caption</span>&#123;subfigure 3&#125;</span><br><span class="line">      <span class="keyword">\label</span>&#123;subfig:aggregate&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">    <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">      <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">      <span class="keyword">\caption</span>&#123;subfigure 4&#125;</span><br><span class="line">      <span class="keyword">\label</span>&#123;subfig:assign&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">    <span class="keyword">\hspace</span>&#123;0.15<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;subfigure&#125;&#123;0.3<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">      <span class="keyword">\includegraphics</span>[width=<span class="keyword">\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class="line">      <span class="keyword">\caption</span>&#123;subfigure 5&#125;</span><br><span class="line">      <span class="keyword">\label</span>&#123;subfig:newroute&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;subfigure&#125;</span><br><span class="line">    <span class="keyword">\caption</span>&#123;<span class="keyword">\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;figure&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;landscape&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>这会得到一个横置的页面,注意到这个页面是横置的，所有的内容在页面的上方，下一步是把这些图片垂直居中。<br>
<img src="/2024/08/24/2024-08-24-elsarticle/landscape.png" alt="横置页面"><br>
只需要在<code>landscape</code>和<code>figure</code>环境之间套一层<code>midpage</code>环境即可。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;lipsum&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;subcaption&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;pdflscape&#125; </span><br><span class="line"><span class="keyword">\usepackage</span>&#123;midpage&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;landscape&#125;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;midpage&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class="line">      ... 图表代码</span><br><span class="line">    <span class="keyword">\end</span>&#123;figure&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;midpage&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;landscape&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>得到居中的插图：<br>
<img src="/2024/08/24/2024-08-24-elsarticle/landscape_center.png" alt="横置+垂直居中"></p>
<p>但是，横置页前后的文字会因为横置页突然打断，出现大面积空白。这时还需要<code>afterpage</code>宏包，使得横置页平滑插入到文字中，用<code>\afterpage&#123;&#125;</code>命令把<code>landscape</code>环境包裹起来。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;lipsum&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;subcaption&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;pdflscape&#125; </span><br><span class="line"><span class="keyword">\usepackage</span>&#123;midpage&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\afterpage</span>&#123;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;landscape&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;midpage&#125;</span><br><span class="line">      <span class="keyword">\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class="line">        ... 图表代码</span><br><span class="line">      <span class="keyword">\end</span>&#123;figure&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;midpage&#125;</span><br><span class="line">  <span class="keyword">\end</span>&#123;landscape&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>生成的效果如图，可见横置页丝滑插入段落中，没有产生大面积空白</p>
<p><img src="/2024/08/24/2024-08-24-elsarticle/landscape_after.png" alt="横置前后段落中间可断页"></p>
<h2 id="禁止分页"><a class="markdownIt-Anchor" href="#禁止分页"></a> 禁止分页</h2>
<p>使用<code>\nopagebreak</code>表示禁止在此处断页。</p>
<p>此外，还可以使用</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;parskip&#125;</span><br><span class="line"><span class="keyword">\AddToHook</span>&#123;env/samepage/begin&#125;&#123;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\AddToHook</span>&#123;para/before&#125;&#123;<span class="keyword">\nopagebreak</span>&#125;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\AddToHook</span>&#123;para/after&#125;&#123;<span class="keyword">\nopagebreak</span>&#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;samepage&#125;</span><br><span class="line">在一页的第一段</span><br><span class="line"></span><br><span class="line">在一页的第二段</span><br><span class="line"><span class="keyword">\end</span>&#123;samepage&#125;</span><br></pre></td></tr></table></figure>
<p>另两个段落出现在同一页。</p>
<h2 id="公式间距微调"><a class="markdownIt-Anchor" href="#公式间距微调"></a> 公式间距微调</h2>
<p>参考这篇文章<a target="_blank" rel="noopener" href="https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing">https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing</a><br>
下面的源代码将在字母ab之间产生不同大小的横向间距。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>[margin=1in]&#123;geometry&#125;<span class="comment">% Just for this example</span></span><br><span class="line"><span class="keyword">\setlength</span>&#123;<span class="keyword">\parindent</span>&#125;&#123;0pt&#125;<span class="comment">% Just for this example</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line">There are a number of horizontal spacing macros for LaTeX:</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;lp&#123;5cm&#125;&#125;</span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\,b</span>|                     <span class="built_in">&amp;</span> a<span class="keyword">\,</span>b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\,</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\thinspace b</span>|            <span class="built_in">&amp;</span> a<span class="keyword">\thinspace</span> b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\thinspace</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\!b</span>|                     <span class="built_in">&amp;</span> a<span class="keyword">\!</span>b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\!</span>b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\negthinspace b</span>|         <span class="built_in">&amp;</span> a<span class="keyword">\negthinspace</span> b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\negthinspace</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\:b</span>|                     <span class="built_in">&amp;</span> a<span class="keyword">\:</span>b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\:</span>b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\&gt;b</span>|                     <span class="built_in">&amp;</span> a<span class="keyword">\&gt;</span>b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\&gt;</span>b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\medspace b</span>|             <span class="built_in">&amp;</span> a<span class="keyword">\medspace</span> b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\medspace</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\negmedspace b</span>|          <span class="built_in">&amp;</span> a<span class="keyword">\negmedspace</span> b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\negmedspace</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\;b</span>|                     <span class="built_in">&amp;</span> a<span class="keyword">\;</span>b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\;</span>b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\thickspace b</span>|           <span class="built_in">&amp;</span> a<span class="keyword">\thickspace</span> b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\thickspace</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\negthickspace b</span>|        <span class="built_in">&amp;</span> a<span class="keyword">\negthickspace</span> b <span class="keyword">\quad</span> <span class="built_in">$</span>a<span class="keyword">\negthickspace</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\mkern\thinmuskip b$</span>|   <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\mkern</span><span class="keyword">\thinmuskip</span> b<span class="built_in">$</span> (similar to <span class="keyword">\verb</span>|<span class="string">\,</span>|) <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\mkern-\thinmuskip b$</span>|  <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\mkern</span>-<span class="keyword">\thinmuskip</span> b<span class="built_in">$</span> (similar to <span class="keyword">\verb</span>|<span class="string">\!</span>|) <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\mkern\medmuskip b$</span>|    <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\mkern</span><span class="keyword">\medmuskip</span> b<span class="built_in">$</span> (similar to <span class="keyword">\verb</span>|<span class="string">\:</span>| or <span class="keyword">\verb</span>|<span class="string">\&gt;</span>|) <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\mkern-\medmuskip b$</span>|   <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\mkern</span>-<span class="keyword">\medmuskip</span> b<span class="built_in">$</span> (similar to <span class="keyword">\verb</span>|<span class="string">\negmedspace</span>|) <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\mkern\thickmuskip b$</span>|  <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\mkern</span><span class="keyword">\thickmuskip</span> b<span class="built_in">$</span> (similar to <span class="keyword">\verb</span>|<span class="string">\;</span>|) <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\mkern-\thickmuskip b$</span>| <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\mkern</span>-<span class="keyword">\thickmuskip</span> b<span class="built_in">$</span> (similar to <span class="keyword">\verb</span>|<span class="string">\negthickspace</span>|) <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\enspace b</span>|              <span class="built_in">&amp;</span> a<span class="keyword">\enspace</span> b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\enspace b$</span>|            <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\enspace</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\quad b</span>|                 <span class="built_in">&amp;</span> a<span class="keyword">\quad</span> b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\quad b$</span>|               <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\quad</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\qquad b</span>|                <span class="built_in">&amp;</span> a<span class="keyword">\qquad</span> b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\qquad b$</span>|              <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\qquad</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\hskip 1em b</span>|            <span class="built_in">&amp;</span> a<span class="keyword">\hskip</span> 1em b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\hskip 1em b$</span>|          <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\hskip</span> 1em b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\kern 1pc b</span>|             <span class="built_in">&amp;</span> a<span class="keyword">\kern</span> 1pc b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\kern 1pc b$</span>|           <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\kern</span> 1pc b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\mkern 17mu b$</span>|         <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\mkern</span> 17mu b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\hspace&#123;35pt&#125;b</span>|          <span class="built_in">&amp;</span> a<span class="keyword">\hspace</span>&#123;35pt&#125;b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\hspace&#123;35pt&#125;b$</span>|        <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\hspace</span>&#123;35pt&#125;b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">axyzb</span>|                    <span class="built_in">&amp;</span> axyzb <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\hphantom&#123;xyz&#125;b</span>|         <span class="built_in">&amp;</span> a<span class="keyword">\hphantom</span>&#123;xyz&#125;b (or just <span class="keyword">\verb</span>|<span class="string">\phantom</span>|) <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$axyzb$</span>|                  <span class="built_in">&amp;</span> <span class="built_in">$</span>axyzb<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\hphantom&#123;xyz&#125;b$</span>|       <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\hphantom</span>&#123;xyz&#125;b<span class="built_in">$</span> (or just <span class="keyword">\verb</span>|<span class="string">\phantom</span>|) <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a b</span>|                      <span class="built_in">&amp;</span> a b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a b$</span>|                    <span class="built_in">&amp;</span> <span class="built_in">$</span>a b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\space b</span>|                <span class="built_in">&amp;</span> a<span class="keyword">\space</span> b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\space b$</span>|              <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\space</span> b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\ b</span>|                     <span class="built_in">&amp;</span> a<span class="keyword">\ </span>b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\ b$</span>|                   <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\ </span>b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a&#123; &#125;b</span>|                    <span class="built_in">&amp;</span> a&#123; &#125;b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a&#123; &#125;b$</span>|                  <span class="built_in">&amp;</span> <span class="built_in">$</span>a&#123; &#125;b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a~b</span>|                      <span class="built_in">&amp;</span> a~b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a~b$</span>|                    <span class="built_in">&amp;</span> <span class="built_in">$</span>a~b<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">a\hfill b</span>|                <span class="built_in">&amp;</span> a<span class="keyword">\hfill</span> b <span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\verb</span>|<span class="string">$a\hfill b$</span>|              <span class="built_in">&amp;</span> <span class="built_in">$</span>a<span class="keyword">\hfill</span> b<span class="built_in">$</span></span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>其中，可以在公式环境内部调整间距。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation&#125;</span><br><span class="line"><span class="keyword">\thinmuskip</span>=3mu</span><br><span class="line"><span class="keyword">\medmuskip</span>=4mu plus 2mu minus 4mu</span><br><span class="line"><span class="keyword">\thickmuskip</span>=5mu plus 5mu</span><br><span class="line">a + b = c</span><br><span class="line"><span class="keyword">\end</span>&#123;equation&#125;</span><br></pre></td></tr></table></figure>
<p>最后，<code>align</code>环境调整行距，只需在<code>\\</code>之后加<code>[行距]</code>即可。</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">    f(x)=x<span class="built_in">^</span>&#123;2&#125;-2x+1<span class="keyword">\\</span>[10pt]</span><br><span class="line">    f(x)=(x-1)<span class="built_in">^</span>&#123;2&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125; </span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/08/18/2024-08-18-%E5%86%99%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/08/18/2024-08-18-%E5%86%99%E4%BD%9C/" class="post-title-link" itemprop="url">运筹写作的数学定理、命题等相关术语和应用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-08-18 00:07:00" itemprop="dateCreated datePublished" datetime="2024-08-18T00:07:00+08:00">2024-08-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-27 12:01:01" itemprop="dateModified" datetime="2024-08-27T12:01:01+08:00">2024-08-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>前言</strong>：在运筹论文中，总会出现一些Proposition, Theorem, 等类似的模型相关术语，<br>
理解这些术语的内涵有助于揣测作者写作的着重点，更有助于理解文章的内容。</p>
<h1 id="术语-含义"><a class="markdownIt-Anchor" href="#术语-含义"></a> 术语、含义</h1>
<table>
<thead>
<tr>
<th>术语</th>
<th>含义</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>Definition</td>
<td>定义</td>
<td>定义一个词的含义</td>
</tr>
<tr>
<td>Theorem</td>
<td>定理</td>
<td>已经被证明的是正确的内容</td>
</tr>
<tr>
<td>Proposition</td>
<td>命题</td>
<td>不那么重要，但是又有点意思的正确的陈述</td>
</tr>
<tr>
<td>Lemma</td>
<td>引理</td>
<td>用于证明其他内容的正确陈述</td>
</tr>
<tr>
<td>Corollary</td>
<td>推论</td>
<td>从定理或命题中推导的正确陈述</td>
</tr>
<tr>
<td>Proof</td>
<td>证明</td>
<td>解释写的东西为什么是正确的</td>
</tr>
<tr>
<td>Conjecture</td>
<td>猜想</td>
<td>认为是正确的，但是没证出来的陈述</td>
</tr>
<tr>
<td>Axiom</td>
<td>公理</td>
<td>关于数学的基本假设</td>
</tr>
<tr>
<td>Note</td>
<td>注释</td>
<td>澄清没有解释清楚的事情</td>
</tr>
<tr>
<td>Remark</td>
<td>评述</td>
<td>强调\讨论\评论其他的概念或见解</td>
</tr>
</tbody>
</table>
<h1 id="个人理解"><a class="markdownIt-Anchor" href="#个人理解"></a> 个人理解</h1>
<p>上述的术语在应用类型的运筹文章中，比较常见的有Definition、Theorem、Proposition、Lemma、Proof。<br>
通常在模型或问题提出后，为了增加文章的理论深度，提出一些关于模型的有意思的、略带深度的性质，并提供证明Proof。<br>
个人觉得Theorem是一个严肃的内容，其定义是“已经被证明的正确的内容“，但是在文章中证明出来了，<br>
就算的上是”已经被证明“了。</p>
<p>Lemma、Proposition、Theorem的边界并不是清晰的，所以怎么用都行。<br>
但是重要性的排序个人认为是：Theorem &gt; Proposition &gt; Lemma。</p>
<p>Remark一般在证明最后，强调一下和其他人的不同，或者强调有意义的事情。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yrf990409.github.io/2024/07/12/2024-07-21-matlab/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yu Runfeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runfeng的万事屋">
      <meta itemprop="description" content="个人学习记录, 一些运筹, 一些代码, 一些吐槽">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Runfeng的万事屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/12/2024-07-21-matlab/" class="post-title-link" itemprop="url">Matlab程序开发经验分享</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-12 12:00:00" itemprop="dateCreated datePublished" datetime="2024-07-12T12:00:00+08:00">2024-07-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-24 17:20:13" itemprop="dateModified" datetime="2024-10-24T17:20:13+08:00">2024-10-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>记录在学校的一次matlab课上的技术分享。</p>
<p><strong>前言</strong>：本次分享的主要内容是介绍一些我个人Matlab开发常用的经验总结，<br>
目的是让大家了解到matlab的优缺点、独特性、技巧，以及用什么方法解决什么问题。<br>
Matlab是一个复杂的工具，并不是我凭借一己之力可以完全说清楚的。<br>
大部分各种理工科离不开这一工具，而各个学科之间隔行如隔山，<br>
我只是把自己经常使用的经验进行总结，和各位共同分享。</p>
<p><strong>假设</strong>：今天不会涉及编程思想（函数式、面向对象等），主要是向大家分享如何用好这一工具。<br>
假设各位已经掌握matlab的基本语法，并且自己也会写一些代码了。</p>
<h1 id="代码优化"><a class="markdownIt-Anchor" href="#代码优化"></a> 代码优化</h1>
<blockquote>
<p>同样是跑代码，为什么我要等很久？</p>
</blockquote>
<p>我们不得不承认，Matlab这种解释型语言比编译型语言要慢（代码在运行时会被一行一行地解释执行），<br>
这并不代表Matlab代码不能变得高效。</p>
<h2 id="预分配内存"><a class="markdownIt-Anchor" href="#预分配内存"></a> 预分配内存</h2>
<p>在进行循环语句时，应当先声明变量所需空间的大小，再进行循环，避免每次循环向数组中增加数字。</p>
<p><strong>不推荐写法</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tic</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">1000</span></span><br><span class="line">	mat(<span class="built_in">i</span>,<span class="built_in">i</span>) = <span class="built_in">i</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br><span class="line"><span class="comment">% 历时 0.115061 秒。</span></span><br></pre></td></tr></table></figure>
<p><strong>推荐写法</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tic</span><br><span class="line">mat_2 = <span class="built_in">zeros</span>(<span class="number">1000</span>); <span class="comment">% 先把数组的大小声明，在内存中开辟一块空间</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">1000</span></span><br><span class="line">	mat_2(<span class="built_in">i</span>,<span class="built_in">i</span>) = <span class="built_in">i</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br><span class="line"><span class="comment">% 历时 0.005585 秒。</span></span><br></pre></td></tr></table></figure>
<p><strong>为什么出现这样的差异？</strong></p>
<p>反复调整数组的大小将导致花费额外的时间找到更大的、<strong>连续的</strong>内存空间。</p>
<p><strong>所有类型的变量都需要这样做吗？</strong></p>
<p>不一定，cell类型则不需要，但是放在cell中的数据类型可能需要。<br>
cell数组内存不连续，但是每个cell要求连续内存。<br>
（部分情况下cell在编译成mex文件时，同样需要初始化内存）</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/matlab/matlab_prog/preallocating-arrays.html">https://ww2.mathworks.cn/help/matlab/matlab_prog/preallocating-arrays.html</a></p>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/matlab/matlab_prog/techniques-for-improving-performance.html">https://ww2.mathworks.cn/help/matlab/matlab_prog/techniques-for-improving-performance.html</a></p>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/matlab/matlab_prog/avoid-unnecessary-copies-of-data.html">https://ww2.mathworks.cn/help/matlab/matlab_prog/avoid-unnecessary-copies-of-data.html</a></p>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/matlab/matlab_prog/strategies-for-efficient-use-of-memory.html">https://ww2.mathworks.cn/help/matlab/matlab_prog/strategies-for-efficient-use-of-memory.html</a></p>
<h2 id="向量化"><a class="markdownIt-Anchor" href="#向量化"></a> 向量化</h2>
<p>官方定义：</p>
<blockquote>
<p>修正基于循环且面向标量的代码以使用 MATLAB 矩阵和向量运算的过程称为<em><strong>向量化</strong></em>。</p>
</blockquote>
<p>简单来说，就是替代for循环做一些简单操作，以提高运行速度、可读性、正确性。即，算法流程控制<code>for</code>循环，简单操作向量化。<br>
<strong>向量化是matlab的一个重要特点，这在其他语言很少出现</strong><br>
向量化的语句通常有底层的支持，利用到了CPU指令集进行优化，因此速度较快，<br>
而for循环遍历慢的原因是matlab为解释性语言需要一行一行执行。</p>
<h3 id="求1至10000的每个数的正弦的和"><a class="markdownIt-Anchor" href="#求1至10000的每个数的正弦的和"></a> 求1至10000的每个数的正弦的和</h3>
<p><strong>循环写法：</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tic</span><br><span class="line">all_sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">1e4</span></span><br><span class="line">	all_sum = all_sum + <span class="built_in">sin</span>(<span class="built_in">i</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;all_sum: &#x27;</span>, num2str(all_sum)])</span><br><span class="line">toc</span><br><span class="line"><span class="comment">% all_sum: 1.6339</span></span><br><span class="line"><span class="comment">% 历时 0.038938 秒。</span></span><br></pre></td></tr></table></figure>
<p><strong>向量化写法：</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tic</span><br><span class="line">all_sum = sum(<span class="built_in">sin</span>(<span class="number">1</span>:<span class="number">1e4</span>));</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;all_sum: &#x27;</span>, num2str(all_sum)])</span><br><span class="line">toc</span><br><span class="line"><span class="comment">% all_sum: 1.6339</span></span><br><span class="line"><span class="comment">% 历时 0.008211 秒。</span></span><br></pre></td></tr></table></figure>
<p>为什么<code>all_sum</code>这么小？</p>
<h3 id="隐式扩展求每个人每科成绩与平均值的差距"><a class="markdownIt-Anchor" href="#隐式扩展求每个人每科成绩与平均值的差距"></a> 隐式扩展，求每个人每科成绩与平均值的差距</h3>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 每个人有三门课，</span></span><br><span class="line"><span class="comment">%    数 语  外</span></span><br><span class="line">A = [<span class="number">97</span> <span class="number">89</span> <span class="number">84</span>; </span><br><span class="line">     <span class="number">95</span> <span class="number">82</span> <span class="number">92</span>; </span><br><span class="line">     <span class="number">64</span> <span class="number">80</span> <span class="number">99</span>;</span><br><span class="line">     <span class="number">76</span> <span class="number">77</span> <span class="number">67</span>;</span><br><span class="line">     <span class="number">88</span> <span class="number">59</span> <span class="number">74</span>; </span><br><span class="line">     <span class="number">78</span> <span class="number">66</span> <span class="number">87</span>; </span><br><span class="line">     <span class="number">55</span> <span class="number">93</span> <span class="number">85</span>];		<span class="comment">% 每一列是一个人</span></span><br></pre></td></tr></table></figure>
<p><strong>循环写法</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mA = <span class="built_in">mean</span>(A);			<span class="comment">% 求每列的平均值</span></span><br><span class="line">B = <span class="built_in">zeros</span>(<span class="built_in">size</span>(A));		<span class="comment">% 记录每个人每门课的差距</span></span><br><span class="line"><span class="keyword">for</span> n = <span class="number">1</span>:<span class="built_in">size</span>(A,<span class="number">2</span>)		<span class="comment">% 对每一列进行操作</span></span><br><span class="line">    B(:,n) = A(:,n) - mA(n);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p><strong>向量化写法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devA = A - mean(A)</span><br></pre></td></tr></table></figure>
<p>注意，在向量化写法中，<code>mean(A)</code>的结果是1x3大小的。即使 <code>A</code> 是一个 7×3 矩阵，<code>mean(A)</code> 是一个 1×3 向量，MATLAB 也会隐式扩展该向量，就好像其大小与矩阵相同一样，并且该运算将作为正常的按元素减法运算来执行。（广播操作）</p>
<h3 id="逻辑索引线性索引下标索引"><a class="markdownIt-Anchor" href="#逻辑索引线性索引下标索引"></a> 逻辑索引，线性索引，下标索引</h3>
<p><strong>介绍三种索引方式的区别</strong></p>
<p>一个矩阵A ，寻找这个矩阵中大于500的数字的行列数</p>
<p><strong>循环方法</strong>（单个循环，获得线性索引，双层循环，获得行列数）</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">A = <span class="built_in">magic</span>(<span class="number">100</span>);</span><br><span class="line">tic</span><br><span class="line">sub = <span class="built_in">zeros</span>(sum(A&gt;<span class="number">500</span>, <span class="string">&#x27;all&#x27;</span>), <span class="number">2</span>);</span><br><span class="line">count = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">100</span></span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="number">100</span></span><br><span class="line">		<span class="keyword">if</span> A(<span class="built_in">i</span>,<span class="built_in">j</span>) &gt; <span class="number">500</span></span><br><span class="line">			sub(count,:) = [<span class="built_in">i</span>,<span class="built_in">j</span>];</span><br><span class="line">			count = count + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br></pre></td></tr></table></figure>
<p><strong>find方法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = magic(100);</span><br><span class="line">tic</span><br><span class="line">[row, col] = find(A&gt;500);</span><br><span class="line">sub = [row, col];</span><br><span class="line">toc</span><br></pre></td></tr></table></figure>
<p><strong>处处用find真的合适吗？</strong></p>
<p>求矩阵A中，所有大于500的数的和</p>
<p><code>sum(A(find(A&gt;500)))</code>线性索引</p>
<!-- image-20231001192302431.png -->
<p><img src="/2024/07/12/2024-07-21-matlab/image-20230930182045754.png" alt="image-20230930182045754"></p>
<p><code>sum(A&gt;500))</code>这里直接使用了逻辑索引，速度比<code>find()</code>更快。</p>
<h3 id="重复数组"><a class="markdownIt-Anchor" href="#重复数组"></a> 重复数组</h3>
<p>根据向量、矩阵创造大的重复矩阵。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">A = <span class="built_in">repmat</span>(<span class="number">1</span>:<span class="number">3</span>,<span class="number">5</span>,<span class="number">2</span>)</span><br><span class="line">B = <span class="built_in">repmat</span>([<span class="number">1</span> <span class="number">2</span>; <span class="number">3</span> <span class="number">4</span>],<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% A =</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%     1     2     3     1     2     3</span></span><br><span class="line"><span class="comment">%     1     2     3     1     2     3</span></span><br><span class="line"><span class="comment">%     1     2     3     1     2     3</span></span><br><span class="line"><span class="comment">%     1     2     3     1     2     3</span></span><br><span class="line"><span class="comment">%     1     2     3     1     2     3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% B =</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%     1     2     1     2</span></span><br><span class="line"><span class="comment">%     3     4     3     4</span></span><br><span class="line"><span class="comment">%     1     2     1     2</span></span><br><span class="line"><span class="comment">%     3     4     3     4</span></span><br></pre></td></tr></table></figure>
<h3 id="思考题多个等间隔指针的轮盘赌如何向量化"><a class="markdownIt-Anchor" href="#思考题多个等间隔指针的轮盘赌如何向量化"></a> 思考题：多个等间隔指针的轮盘赌如何向量化？</h3>
<p>随机遍历抽样（SUS）<br>
从轮盘赌选择N个结果，则需转动N次转盘。<br>
然而这样的抽选方式存在一定的不合理性，比如某个区域在轮盘中占据较大的份额，N次转动很有可能多次选中这个个体。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-wheel.jpg" alt="image-20230930192441679"></p>
<p>现在想一次性选中多个区域，而且尽量不重复。<br>
使用SUS只需转动一个等间隔指针的圆盘一次，转一次就可以选出所需区域。</p>
<p><strong>SUS步骤</strong><br>
假设轮盘总值为F（可以是1），指针选择区域数目为N，则SUS具体步骤如下：</p>
<p>STEP1：计算指针的间距P=F/N；</p>
<p>STEP2：随机生成起点指针位置Start=[0~P之间的随机数]；</p>
<p>STEP3：计算各指针的位置Pointers=[Start+i*P(其中i=[0,1,…N-1])]；</p>
<p>STEP4：根据各指针位置，选择出N个个体。</p>
<p>for循环代码</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sel_ind</span> = <span class="title">sus_loop</span><span class="params">(fitness, sel_num)</span></span></span><br><span class="line"><span class="comment">% sus for循环实现，输入适应度和要选择的个数</span></span><br><span class="line"><span class="comment">% 输出被选择的个体的索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 验证输入的正确性</span></span><br><span class="line"><span class="comment">% 要求fitness是一个列向量， sel_num是一个数</span></span><br><span class="line">validateattributes(fitness, &#123;<span class="string">&#x27;numeric&#x27;</span>&#125;, &#123;<span class="string">&#x27;size&#x27;</span>,[<span class="built_in">nan</span>,<span class="number">1</span>]&#125;)</span><br><span class="line">validateattributes(sel_num, &#123;<span class="string">&#x27;numeric&#x27;</span>&#125;, &#123;<span class="string">&#x27;size&#x27;</span>,[<span class="number">1</span>,<span class="number">1</span>], <span class="string">&#x27;&lt;&#x27;</span>, <span class="built_in">length</span>(fitness)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 初始化</span></span><br><span class="line">wheel = [<span class="number">0</span>; cumsum(fitness ./ sum(fitness))];   <span class="comment">% 构建一个轮盘，所有的适应度之和等于1</span></span><br><span class="line">interval = <span class="number">1</span> /sel_num;                          <span class="comment">% 适应度是1，间距等于选择数量的倒数</span></span><br><span class="line">start = <span class="built_in">rand</span> * interval;                        <span class="comment">% 随机起点位置</span></span><br><span class="line">pointer = (<span class="number">0</span>:interval:interval*(sel_num<span class="number">-1</span>)) + start; <span class="comment">% 指针</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 循环获取索引</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">    sel_ind = <span class="built_in">zeros</span>(sel_num, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:sel_num</span><br><span class="line">        p = pointer(<span class="built_in">i</span>); <span class="comment">% 指针</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">length</span>(wheel)<span class="number">-1</span></span><br><span class="line">            <span class="comment">% 如果指针p落在当前区间内，则这个个体被选中</span></span><br><span class="line">            <span class="keyword">if</span> p &gt;= wheel(<span class="built_in">j</span>) &amp;&amp; p &lt; wheel(<span class="built_in">j</span>+<span class="number">1</span>)</span><br><span class="line">                sel_ind(<span class="built_in">i</span>) = <span class="built_in">j</span>;</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">    save(<span class="string">&#x27;bug_file_sus_loop.mat&#x27;</span>)</span><br><span class="line">    error(<span class="string">&#x27;SUS循环出错&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>向量化代码</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sel_ind</span> = <span class="title">sus_vector</span><span class="params">(fitness, sel_num)</span></span></span><br><span class="line"><span class="comment">% sus for循环实现，输入适应度和要选择的个数</span></span><br><span class="line"><span class="comment">% 输出被选择的个体的索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 验证输入的正确性</span></span><br><span class="line"><span class="comment">% 要求fitness是一个列向量， sel_num是一个数</span></span><br><span class="line">validateattributes(fitness, &#123;<span class="string">&#x27;numeric&#x27;</span>&#125;, &#123;<span class="string">&#x27;size&#x27;</span>,[<span class="built_in">nan</span>,<span class="number">1</span>]&#125;)</span><br><span class="line">validateattributes(sel_num, &#123;<span class="string">&#x27;numeric&#x27;</span>&#125;, &#123;<span class="string">&#x27;size&#x27;</span>,[<span class="number">1</span>,<span class="number">1</span>], <span class="string">&#x27;&lt;&#x27;</span>, <span class="built_in">length</span>(fitness)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 初始化</span></span><br><span class="line">wheel = [<span class="number">0</span>; cumsum(fitness ./ sum(fitness))];   <span class="comment">% 构建一个轮盘，所有的适应度之和等于1</span></span><br><span class="line">interval = <span class="number">1</span> /sel_num;                          <span class="comment">% 适应度是1，间距等于选择数量的倒数</span></span><br><span class="line">start = <span class="built_in">rand</span> * interval;                        <span class="comment">% 随机起点的偏移量</span></span><br><span class="line">pointer = (<span class="number">0</span>:interval:interval*(sel_num<span class="number">-1</span>)) + start; <span class="comment">% 指针</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 向量化获得索引</span></span><br><span class="line">temp = <span class="built_in">bsxfun</span>(@gt, pointer, wheel); <span class="comment">% greater than</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 此时，索引就等于temp每一列最后一个1的索引，也可以是每一列第一个0的索引</span></span><br><span class="line"><span class="comment">% 对每一列求和就行</span></span><br><span class="line">sel_ind = sum(temp)&#x27;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>参考链接：<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/matlab/matlab_prog/vectorization.html">https://ww2.mathworks.cn/help/matlab/matlab_prog/vectorization.html</a></p>
<h2 id="冗余运算"><a class="markdownIt-Anchor" href="#冗余运算"></a> 冗余运算</h2>
<p>消除for循环中的冗余运算有助于提升算法的性能。能放到外层的，就放到外层。</p>
<p>给定一个矩阵A，要求A的每个数乘以当前行数，在加上当前列数，再加一个固定的数</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">size</span>(A, <span class="number">1</span>) <span class="comment">% 行</span></span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">size</span>(A, <span class="number">2</span>)</span><br><span class="line">		<span class="built_in">fix</span> = <span class="number">1</span>;</span><br><span class="line">		tmp = A(<span class="built_in">i</span>,<span class="built_in">j</span>);</span><br><span class="line">		tmp = tmp * <span class="built_in">i</span> + <span class="built_in">j</span>;</span><br><span class="line">		A(<span class="built_in">i</span>,<span class="built_in">j</span>) = tmp + <span class="built_in">fix</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="comment">% fix 提出</span></span><br><span class="line"><span class="built_in">fix</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">size</span>(A, <span class="number">1</span>) <span class="comment">% 行</span></span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">size</span>(A, <span class="number">2</span>)</span><br><span class="line">		tmp = A(<span class="built_in">i</span>,<span class="built_in">j</span>);</span><br><span class="line">		tmp = tmp * <span class="built_in">i</span> + <span class="built_in">j</span>;</span><br><span class="line">		A(<span class="built_in">i</span>,<span class="built_in">j</span>) = tmp + <span class="built_in">fix</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">fix</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">size</span>(A, <span class="number">1</span>) <span class="comment">% 行</span></span><br><span class="line">	A(<span class="built_in">i</span>,:) = A(<span class="built_in">i</span>,:) * <span class="built_in">i</span>;</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">size</span>(A, <span class="number">2</span>)</span><br><span class="line">		A(<span class="built_in">i</span>,<span class="built_in">j</span>) = A(<span class="built_in">i</span>,<span class="built_in">j</span>) + <span class="built_in">j</span> + <span class="built_in">fix</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="comment">% 向量化</span></span><br><span class="line">A = (<span class="number">1</span>:<span class="built_in">size</span>(A, <span class="number">1</span>))&#x27; .* A + (<span class="number">1</span>:<span class="built_in">size</span>(A, <span class="number">2</span>)) + <span class="built_in">fix</span></span><br></pre></td></tr></table></figure>
<h2 id="性能分析"><a class="markdownIt-Anchor" href="#性能分析"></a> 性能分析</h2>
<p><strong>我的代码怎么这么慢？想改，改什么呢？</strong></p>
<p>这个时候，需要使用探查器进行代码性能分析</p>
<p>比如对debug.m脚本（模拟禁忌搜索的过程）进行性能分析：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% debug.m</span></span><br><span class="line"><span class="comment">% 模拟禁忌搜索的过程</span></span><br><span class="line">tic</span><br><span class="line">tabu = <span class="built_in">zeros</span>(<span class="number">30</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">1e5</span></span><br><span class="line">    rand_int = [randi(<span class="number">15</span>), randi(<span class="number">15</span>)];</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ismember</span>(rand_int, tabu, <span class="string">&quot;rows&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        tabu = [rand_int; tabu(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>, :)];</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br></pre></td></tr></table></figure>
<p><strong>Step 1. 打开探查器</strong></p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20230930192441679.png" alt="image-20230930192441679"></p>
<p><strong>Step 2. 在探查器中运行代码</strong></p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20230930192625728.png" alt="image-20230930192625728"></p>
<p><strong>Step 3. 点击函数名称 获得具体情况</strong></p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20230930192855816.png" alt="image-20230930192855816"></p>
<p>发现原来是<code>ismember</code>函数运行太慢了，所以根据问题特性，我们自己写一个<code>my_ismember</code>函数，替换原有的<code>ismember</code>函数。</p>
<p>原<code>ismember</code>函数耗时4.931秒，自己写的<code>my_ismember</code>函数耗时0.937秒。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20230930194758499.png" alt="image-20230930194758499"></p>
<p>上述例子说明：</p>
<ul>
<li>
<p>不一定内置函数就足够好，一些函数内置函数为了支持各种数据类型、大小，还是很慢的</p>
</li>
<li>
<p>根据问题、数据结果特征进行重构</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flag</span> = <span class="title">my_ismember</span><span class="params">(a, b)</span></span></span><br><span class="line"><span class="comment">% 判断a是否在b中</span></span><br><span class="line"></span><br><span class="line">validateattributes(a, &#123;<span class="string">&#x27;numeric&#x27;</span>&#125;, &#123;<span class="string">&#x27;size&#x27;</span>,[<span class="number">1</span>,<span class="number">2</span>]&#125;)</span><br><span class="line">validateattributes(b, &#123;<span class="string">&#x27;numeric&#x27;</span>&#125;, &#123;<span class="string">&#x27;size&#x27;</span>,[<span class="built_in">nan</span>,<span class="number">2</span>]&#125;)</span><br><span class="line"></span><br><span class="line">col_1_flag = b(:, <span class="number">1</span>) == a(<span class="number">1</span>);</span><br><span class="line">col_2_flag = b(:, <span class="number">2</span>) == a(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> any(col_1_flag &amp; col_2_flag)</span><br><span class="line">    flag = <span class="built_in">true</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    flag = <span class="built_in">false</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 探查器中运行的代码速度包括了统计时间，因此比一般方式下运行更慢。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html">https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html</a></p>
</li>
</ul>
<h2 id="使用更具效率的算法"><a class="markdownIt-Anchor" href="#使用更具效率的算法"></a> 使用更具效率的算法</h2>
<p>有些时候，真正慢的是使用的算法的复杂度很高（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>甚至<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, 或者说是算法过于朴素），跟向量化等上述技术无关。这种慢根源于算法的复杂度，解决方法是换个思路重写。</p>
<h3 id="双数之和"><a class="markdownIt-Anchor" href="#双数之和"></a> 双数之和</h3>
<p>给定一个整数数组 <code>nums</code> 和一个整数目标值 <code>target</code>，请你在该数组中找出 <strong>和为目标值</strong> <em><code>target</code></em> 的那 <strong>两个</strong> 整数，并返回它们的数组下标。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 输入：nums = [2,7,11,15], target = 9</span></span><br><span class="line"><span class="comment">% 输出：[0,1]</span></span><br><span class="line"><span class="comment">% 解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 随机构造</span></span><br><span class="line">rng(<span class="built_in">pi</span>);</span><br><span class="line">nums = [<span class="number">2</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">15</span>];</span><br><span class="line">rand_num = randperm(<span class="number">5e4</span>) + <span class="number">20</span>;</span><br><span class="line">nums = [nums, randperm(<span class="number">5e4</span>) + <span class="number">20</span>];</span><br><span class="line"></span><br><span class="line">nums = nums(randperm(<span class="built_in">length</span>(nums))); <span class="comment">% nums长度为50004 </span></span><br><span class="line">target = <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line">tic</span><br><span class="line">two_sum(nums, target)</span><br><span class="line">toc</span><br><span class="line"><span class="comment">% ans =</span></span><br><span class="line"><span class="comment">%       36335       36975</span></span><br><span class="line"><span class="comment">% 历时 4.324590 秒。</span></span><br><span class="line"></span><br><span class="line">tic</span><br><span class="line">two_sum_hash(nums, target)</span><br><span class="line">toc</span><br><span class="line"><span class="comment">% ans = </span></span><br><span class="line"><span class="comment">%       36335       36975</span></span><br><span class="line"><span class="comment">% 历时 0.020854 秒。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%  足足200倍速度差距</span></span><br></pre></td></tr></table></figure>
<p><strong>暴力枚举（朴素）算法</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">output</span> = <span class="title">two_sum</span><span class="params">(nums, target)</span></span></span><br><span class="line"><span class="comment">% O(N^2)</span></span><br><span class="line">len_num = <span class="built_in">length</span>(nums);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:len_num</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:len_num</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">i</span> == <span class="built_in">j</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> nums(<span class="built_in">i</span>) + nums(<span class="built_in">j</span>) == target</span><br><span class="line">            output = [<span class="built_in">i</span>,<span class="built_in">j</span>];</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p><strong>字典 - 空间换时间</strong></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">output</span> = <span class="title">two_sum_hash</span><span class="params">(nums, target)</span></span></span><br><span class="line"><span class="comment">% 该代码使用了dictionary()， 仅支持2022b以上版本</span></span><br><span class="line">len_num = <span class="built_in">length</span>(nums);</span><br><span class="line">d = dictionary(nums, <span class="number">1</span>:len_num); <span class="comment">% O(N)</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:len_num <span class="comment">% O(N)</span></span><br><span class="line">    val_1 = nums(<span class="built_in">i</span>);</span><br><span class="line">    val_2 = target - val_1;</span><br><span class="line">    <span class="keyword">if</span> isKey(d, val_2) &amp;&amp; d(val_2) ~= <span class="built_in">i</span></span><br><span class="line">        output = [d(val_2), <span class="built_in">i</span>];</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h1 id="font-colordd0000工具箱font"><a class="markdownIt-Anchor" href="#font-colordd0000工具箱font"></a> <font color="#dd0000">工具箱</font></h1>
<h2 id="matalb-coder"><a class="markdownIt-Anchor" href="#matalb-coder"></a> Matalb Coder</h2>
<p>Matlab和python一样是一门解释性语言，因此运行速度不如编译型语言（C++等），因此一些复杂的函数运行起来相对较慢。</p>
<p>不过，Matlab Coder提供了一种方法，使得我们可以将一个函数编译成C或C++或二进制文件，供Matlab使用。步骤如下：</p>
<p>你需要一个Matlab  Coder工具箱。如果没有，则在附加功能中获取。在顶部APP中打开Coder。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001134101744.png" alt="image-20231001134101744"></p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001134208296.png" alt="image-20231001134208296"></p>
<ul>
<li><strong>进入Select环节</strong>：键入你想编译的函数，注意只能是函数，不能是脚本。这里以<code>lagrangian_relax</code>函数为例，然后点击next。<img src="/2024/07/12/2024-07-21-matlab/image-20231001134303941.png" alt="image-20231001134303941"></li>
<li><strong>进入 review环节</strong>：在这个环节，Coder会检查你的代码有无问题，这个步骤会检查<code>lagrangian_relax</code>函数调用的所有函数。<img src="/2024/07/12/2024-07-21-matlab/image-20231001134944337.png" alt="image-20231001134944337"></li>
</ul>
<p>在底部出现了一条警告，此时应注意，警告和错误是不同的，程序可以有警告（前提是已知警告产生的原因和后果），错误则不同。错误将直接导致程序运行不通。</p>
<p>解决完所有问题后，点Next。</p>
<ul>
<li>
<p><strong>进入Define环节</strong>: 该环节定义了所有变量的类型&amp;大小。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001135319241.png" alt="image-20231001135319241"></p>
<p>在上方的框中，输入调用<code>lagrangian_relax</code>函数的脚本，然后点<code>Autodefine Input Types</code>按钮，等程序运行，所有的变量的大小自动确定。<strong>但是</strong>，自动确定的变量大小类型是固定的，也就是说只能输入这种大小的数据，所以，对一些不确定大小的数据，需要手动将大小调整成inf。点Next，继续。</p>
</li>
<li>
<p><strong>进入 check环节</strong>：Coder会运行之前输入的脚本，检查是否有运行问题、编译问题等等。这一步可能会出现各种报错，这些报错的原因并不是<code>lagrangian_relax</code>函数的结果有问题，而是写脚本的习惯超出编译器可理解的范围，或者编译器认为写的不严谨，数据类型/大小匹配等一系列问题。需要逐个修改，直至通过编译。</p>
</li>
</ul>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001140304900.png" alt="image-20231001140304900"></p>
<ul>
<li>
<p><strong>进入 generate环节</strong>：如果仅仅想在matlab中调用编译好的二进制文件提升运行速度，那么选择mex即可，点Geneate等待生成。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001140519650.png" alt="image-20231001140519650"></p>
</li>
<li>
<p><strong>完成</strong><br>
<img src="/2024/07/12/2024-07-21-matlab/image-20231001140532936.png" alt="image-20231001140532936"></p>
</li>
</ul>
<p>接下来，我们就可以像使用一个普通函数一样使用这个mex文件了。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tic</span><br><span class="line">lagrangian_relax_mex(data, super_cus, param); <span class="comment">% 生成的mex文件</span></span><br><span class="line">toc</span><br><span class="line"><span class="comment">% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % </span></span><br><span class="line"><span class="comment">% LR finish: max iteration</span></span><br><span class="line"><span class="comment">% 历时 3.555206 秒。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tic</span><br><span class="line">lagrangian_relax(data, super_cus, param); <span class="comment">% 原来的函数</span></span><br><span class="line">toc</span><br><span class="line"><span class="comment">% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % </span></span><br><span class="line"><span class="comment">% LR finish: max iteration</span></span><br><span class="line"><span class="comment">% 历时 93.820573 秒。</span></span><br></pre></td></tr></table></figure>
<p>可以观察到，两种方法输出的结果是一样的，但是速度差了30倍。</p>
<p><strong>Coder的缺点：</strong></p>
<ul>
<li>
<p>并不是所有内置函数都支持Coder的，例如dictionary就不支持。不支持的函数会在编译时报错。</p>
</li>
<li>
<p>Coder编译的文件来源于选择的C++编译器，很可能出现mex文件在另一台电脑上无法运行的情况。</p>
</li>
<li>
<p>Coder编译的文件的另一个问题是不能跨平台，mac/win/linux编译得到的文件是不同的。</p>
</li>
</ul>
<p>参考链接：<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/releases/R2020b/coder/gs/generating-mex-functions-from-matlab-code-at-the-command-line.html">通过生成 MEX 函数加快 MATLAB 算法的执行速度</a></p>
<p>​					<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/products/matlab-coder.html">从 MATLAB 代码生成 C 和 C++ 代码</a></p>
<p>​					<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/604283307">MATLAB Coder入门到放弃</a></p>
<p>​					<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36584460/article/details/110791330">https://blog.csdn.net/qq_36584460/article/details/110791330</a></p>
<h2 id="并行计算工具箱-parallel-computing-toolbox"><a class="markdownIt-Anchor" href="#并行计算工具箱-parallel-computing-toolbox"></a> 并行计算工具箱 parallel computing toolbox</h2>
<p>前面提到过利用多核心进行并行计算，需要并行计算工具箱。</p>
<blockquote>
<p>该工具箱通过在本地运行的 worker（MATLAB 计算引擎）上执行应用程序，允许你充分利用多核台式机的处理能力。无需更改代码，即可在集群或云上运行同一个应用程序。还可以将该工具箱与 MATLAB Parallel Server 结合使用，以执行由于太大而无法装入单台机器内存的矩阵计算</p>
</blockquote>
<h3 id="并行for循环"><a class="markdownIt-Anchor" href="#并行for循环"></a> 并行for循环</h3>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tic</span><br><span class="line">n = <span class="number">200</span>;</span><br><span class="line">A = <span class="number">500</span>;</span><br><span class="line">a = <span class="built_in">zeros</span>(<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    a(<span class="built_in">i</span>) = <span class="built_in">max</span>(<span class="built_in">abs</span>(eig(<span class="built_in">rand</span>(A))));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br><span class="line"><span class="comment">% 历时 37.256415 秒。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tic</span><br><span class="line">n = <span class="number">200</span>;</span><br><span class="line">A = <span class="number">500</span>;</span><br><span class="line">a = <span class="built_in">zeros</span>(<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">parfor</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    a(<span class="built_in">i</span>) = <span class="built_in">max</span>(<span class="built_in">abs</span>(eig(<span class="built_in">rand</span>(A)))); <span class="comment">% 最大 / 绝对 / 特征值 / 随机</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br><span class="line"><span class="comment">% 历时 8.028954 秒。</span></span><br></pre></td></tr></table></figure>
<p>使用场景：许多简单计算的循环，parfor将循环划分为组，以便每个线程可以执行一组。</p>
<p>**但是，**循环中一组循环的结果依赖前面某次循环的结果时，不能使用并行计算（归约<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/parallel-computing/reduction-variable.html">Reduction Variables</a>除外）。并行计算有一系列局限性，而且在一些情况下（例如，广播变量）并不能加速代码运行。</p>
<p><strong>使用<code>parfor</code>的情况：</strong></p>
<ul>
<li>每次的for循环很慢（单个时间长）</li>
<li>简单计算的多次循环（单个时间短但是数量多）</li>
<li>多层for嵌套的外层使用parfor更具收益（<strong>思考：为什么？</strong>）</li>
</ul>
<p><strong>不推荐用<code>parfor</code>的情况：</strong></p>
<ul>
<li>已经将for向量化的情况（向量化比parfor收益更高）</li>
<li>循环已经很快了（并行化的时间开销更高，包括初始化，分配等）</li>
</ul>
<p><strong>强烈反对的情况：</strong></p>
<ul>
<li>向量化 -&gt; for循环 -&gt; parfor循环 （反向优化）</li>
</ul>
<p><strong><code>for</code>转<code>parfor</code>的一个不可行举例</strong></p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001201801595.png" alt="image-20231001201801595"></p>
<p>for转parfor一定程度上很复杂，有各式各样的规则限制、写法限制，这里只做一个简单介绍。关于什么时候用parfor，如何将for转为parfor，使用parfor的要求，常见问题等，参见<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/parallel-computing/parallel-for-loops-parfor.html?s_tid=CRUX_lftnav">parfor文档</a>。</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/products/parallel-computing.html">在多核计算机、GPU 和集群上执行并行计算</a></p>
<p><strong>补充：parfor可以和coder结合使用，生成的mex文件也是支持多核计算的</strong></p>
<h2 id="符号计算工具箱-symbolic-math-toolbox"><a class="markdownIt-Anchor" href="#符号计算工具箱-symbolic-math-toolbox"></a> 符号计算工具箱 Symbolic Math Toolbox</h2>
<p>符号计算工具箱，就是能计算数学公式的一个工具箱，变量不再是数值而是符号。因此可以求计算<strong>定积分</strong>和<strong>不定积分</strong>的<strong>解析解</strong>，计算符号表达式或函数的<strong>导数</strong>，并使用级数展开式逼近函数，等等。</p>
<p>例如，求<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mi>sin</mi><mo>⁡</mo><mi>x</mi><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\int_a^b \sin x dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.399828em;vertical-align:-0.35582em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.044008em;"><span style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35582em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span>在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mfrac><mi>π</mi><mn>2</mn></mfrac><mo separator="true">,</mo><mfrac><mrow><mn>3</mn><mi>π</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\frac{\pi}{2}, \frac{3\pi}{2}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span></span>上的积分</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">syms x</span><br><span class="line">int(<span class="built_in">sin</span>(x),<span class="built_in">pi</span>/<span class="number">2</span>,<span class="number">3</span>*<span class="built_in">pi</span>/<span class="number">2</span>)</span><br><span class="line"><span class="comment">% ans = 0</span></span><br></pre></td></tr></table></figure>
<p>这只是一个简单的例子，表示我们可以使用matlab做这件事，具体应用：</p>
<p><strong>某博弈论问题求纳什均衡点</strong></p>
<p>解方程组：</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20240712115425.png" alt="image-20231001203458641"></p>
<p>解得四个解中的一个解为纳什均衡点。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001151417317.png" alt="image-20231001151417317"></p>
<p><strong>纳什均衡点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">E_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的雅克比矩阵</strong></p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001151523651.png" alt="image-20231001151523651"></p>
<p><strong>注：符号计算工具箱不支持coder</strong></p>
<p>如何查看是否支持 coder？详见函数参考文档的底部支持列表</p>
<h1 id="技巧经验"><a class="markdownIt-Anchor" href="#技巧经验"></a> 技巧经验</h1>
<h2 id="使用结构体进行传参"><a class="markdownIt-Anchor" href="#使用结构体进行传参"></a> 使用结构体进行传参</h2>
<p>假设你有一辆车，车长4米，平时跑72km/h，车重1000kg，载重2000kg，现在你写了一个函数<code>f</code>用于估计油耗。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">consume</span> = <span class="title">f</span><span class="params">(len, velocity, weight, capacity)</span></span></span><br><span class="line">	...</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>使用结构体封装一下</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vehicle = struct()</span><br><span class="line">vehicle.len = <span class="number">4</span>;</span><br><span class="line">vehicle.velocity = <span class="number">72</span>;</span><br><span class="line">vehicle.weight = <span class="number">1000</span>;</span><br><span class="line">vehicle.capacity = <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">consume</span> = <span class="title">f</span><span class="params">(vehicle)</span></span></span><br><span class="line">	...</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>包括传出，也可以使用结构体，解决了参数记错的问题。</p>
<p><code>consume = [1, 2, 3, 4]</code></p>
<p><code>consume. air = 1; % 空气阻力产生的燃料消耗</code></p>
<p><code>consume.weight = 2; % 重量产生的消耗</code></p>
<p><code>...</code></p>
<p>给名字就不容易错了，比<code>consume(1)</code> <code>consume(2)</code> 这种要方便</p>
<h2 id="使用句柄函数"><a class="markdownIt-Anchor" href="#使用句柄函数"></a> 使用句柄函数@</h2>
<h3 id="c-bsxfunfunab"><a class="markdownIt-Anchor" href="#c-bsxfunfunab"></a> <code>C = bsxfun(fun,A,B)</code></h3>
<p>Binary Singleton Expansion Function</p>
<p>对数组 <code>A</code> 和 <code>B</code> 应用函数句柄 <code>fun</code> 指定的按元素二元运算。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">A = [<span class="number">8</span>; <span class="number">17</span>; <span class="number">20</span>; <span class="number">24</span>]</span><br><span class="line">B = [<span class="number">0</span> <span class="number">10</span> <span class="number">21</span>]</span><br><span class="line">C = <span class="built_in">bsxfun</span>(@gt,A,B)</span><br><span class="line"></span><br><span class="line"><span class="comment">% C = 4x3 logical array</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%    1   0   0</span></span><br><span class="line"><span class="comment">%    1   1   0</span></span><br><span class="line"><span class="comment">%    1   1   0</span></span><br><span class="line"><span class="comment">%    1   1   1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中<code>@gt</code>的意思是大于&quot;greater than&quot;， 因此生成了隐式扩展结果。</p>
<p>接下来，给定一个向量<code>a</code>和一个向量<code>b</code>，求<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>−</mo><msup><mi>e</mi><mi>b</mi></msup></mrow><annotation encoding="application/x-tex">a-e^b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span></span></span>的所有组合的结果。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>];</span><br><span class="line">b = [<span class="number">5</span>; <span class="number">6</span>; <span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 第一种方法</span></span><br><span class="line">c = <span class="built_in">zeros</span>(<span class="built_in">length</span>(b), <span class="built_in">length</span>(a));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(a)</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">length</span>(b)</span><br><span class="line">		c(<span class="built_in">j</span>,<span class="built_in">i</span>) = a(<span class="built_in">i</span>) - <span class="built_in">exp</span>(b(<span class="built_in">j</span>));</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 第二种方法</span></span><br><span class="line">f = @(a, b) a - <span class="built_in">exp</span>(b);</span><br><span class="line">c = <span class="built_in">bsxfun</span>(f, a, b);</span><br><span class="line"><span class="built_in">disp</span>(c)</span><br></pre></td></tr></table></figure>
<h3 id="a-cellfunfunc-c"><a class="markdownIt-Anchor" href="#a-cellfunfunc-c"></a> <code>A = cellfun(func, C)</code></h3>
<p>对元胞数组<code>C</code>的每个元胞进行操作。</p>
<p>获取元胞数组中，每个元胞的大小</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">C = cell(<span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line">C&#123;<span class="number">1</span>,<span class="number">1</span>&#125; = <span class="string">&#x27;Sunday&#x27;</span>;</span><br><span class="line">C&#123;<span class="number">2</span>,<span class="number">1</span>&#125; = <span class="built_in">magic</span>(<span class="number">3</span>);</span><br><span class="line">C&#123;<span class="number">3</span>,<span class="number">1</span>&#125; = <span class="number">1</span>:<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 循环操作</span></span><br><span class="line">A = <span class="built_in">zeros</span>(<span class="built_in">size</span>(C, <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">size</span>(C, <span class="number">1</span>)</span><br><span class="line">	A(<span class="built_in">i</span>) = <span class="built_in">length</span>(C&#123;<span class="built_in">i</span>,<span class="number">1</span>&#125;(:));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>(A)</span><br><span class="line"><span class="comment">% [6; 9; 10]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% cellfun</span></span><br><span class="line">A = <span class="built_in">cellfun</span>(@(x) <span class="built_in">length</span>(x(:)), C)</span><br><span class="line"><span class="comment">% [6; 9; 10]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="a-structfunfunc-s"><a class="markdownIt-Anchor" href="#a-structfunfunc-s"></a> <code>A = structfun(func, S)</code></h3>
<p>对标量结构体的每个字段应用函数</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">S.f1 = <span class="number">1</span>:<span class="number">10</span>;</span><br><span class="line">S.f2 = [<span class="number">2</span>; <span class="number">4</span>; <span class="number">6</span>];</span><br><span class="line">S.f3 = []</span><br><span class="line"></span><br><span class="line">A = structfun(@<span class="built_in">mean</span>,S)</span><br><span class="line"><span class="comment">% A = 3×1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%     5.5000</span></span><br><span class="line"><span class="comment">%     4.0000</span></span><br><span class="line"><span class="comment">%        NaN</span></span><br></pre></td></tr></table></figure>
<h2 id="运行日志"><a class="markdownIt-Anchor" href="#运行日志"></a> 运行日志</h2>
<p>将命令行窗口文本记录到日志文件中</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">diary <span class="string">&#x27;myDiaryFile.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">10</span></span><br><span class="line">	<span class="built_in">disp</span>(<span class="built_in">exp</span>(<span class="built_in">i</span>))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">diary off</span><br></pre></td></tr></table></figure>
<p>你就会得到一个<code>myDiaryFile.txt</code>文件，用于记录所有打印的结果。</p>
<p>用处：追踪程序运行状况，运行到哪次迭代？运行到哪一步？配合其他函数，还可以记录何时运行等信息。</p>
<h2 id="格式化输出"><a class="markdownIt-Anchor" href="#格式化输出"></a> 格式化输出</h2>
<p>格式化字符串</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">formatSpec = <span class="string">&#x27;The array is %dx%d.&#x27;</span>;</span><br><span class="line">A1 = <span class="number">2</span>;</span><br><span class="line">A2 = <span class="number">3</span>;</span><br><span class="line">str = sprintf(formatSpec,A1,A2)</span><br><span class="line"><span class="comment">% str = </span></span><br><span class="line"><span class="comment">% &#x27;The array is 2x3.&#x27;</span></span><br><span class="line"></span><br><span class="line">fprint(formatSpec,A1,A2)</span><br><span class="line"><span class="comment">% &#x27;The array is 2x3.&#x27;</span></span><br></pre></td></tr></table></figure>
<p>参考： <a target="_blank" rel="noopener" href="https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html">https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html</a></p>
<p>有什么用？多次运行一个函数，但是输入参数不同时，配合<code>diary</code>函数可生成结果日志</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001164150891.png" alt="image-20231001164150891"></p>
<p>解放双手，从自动运行做起，拒绝<strong>手动保存</strong>每次的运行结果。</p>
<h2 id="运行时间"><a class="markdownIt-Anchor" href="#运行时间"></a> 运行时间</h2>
<p>想要获取运行了多久？使用<code>tic</code>和<code>toc</code>函数统计代码运行时间。</p>
<p>高级用法：使用多个<code>tic</code>测量时间</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tStart = tic;           <span class="comment">% pair 2: tic</span></span><br><span class="line">n = <span class="number">10</span>;</span><br><span class="line">T = <span class="built_in">zeros</span>(<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">    A = <span class="built_in">rand</span>(<span class="number">12000</span>,<span class="number">4400</span>);</span><br><span class="line">    B = <span class="built_in">rand</span>(<span class="number">12000</span>,<span class="number">4400</span>);</span><br><span class="line">    tic         <span class="comment">% pair 1: tic</span></span><br><span class="line">    C = A.*B;</span><br><span class="line">    T(<span class="built_in">i</span>)= toc;  <span class="comment">% pair 1: toc</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">tMul = sum(T) <span class="comment">% tMul = 0.6037</span></span><br><span class="line">tEnd = toc(tStart) <span class="comment">% tEnd = 11.6301</span></span><br></pre></td></tr></table></figure>
<p>其他统计代码运行时长的方法：</p>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/releases/R2023b/matlab/ref/cputime.html?">t = cputime</a></p>
<p><a target="_blank" rel="noopener" href="https://www.mathworks.com/help/releases/R2023b/matlab/ref/datetime.html?searchHighlight=datetime&amp;s_tid=doc_srchtitle#d126e310370">t = datetime</a></p>
<h2 id="多层嵌套"><a class="markdownIt-Anchor" href="#多层嵌套"></a> 多层嵌套</h2>
<p>看这样一个代码，每月每天你孤单会想起谁：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> month = <span class="number">1</span>:<span class="number">12</span>  <span class="comment">% 月</span></span><br><span class="line">	<span class="keyword">for</span> day = <span class="number">1</span>:<span class="number">30</span> <span class="comment">% 天</span></span><br><span class="line">		<span class="keyword">if</span> 孤单？</span><br><span class="line">			你想起一个人</span><br><span class="line">			<span class="keyword">if</span> 想找个人来陪</span><br><span class="line">				找！</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>上述代码的问题：嵌套太多了，一层一层的嵌套。（写代码的习惯，不影响执行效率，但是影响可读性）</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> month = <span class="number">1</span>:<span class="number">12</span>  <span class="comment">% 月</span></span><br><span class="line">	<span class="keyword">for</span> day = <span class="number">1</span>:<span class="number">30</span> <span class="comment">% 天</span></span><br><span class="line">		<span class="keyword">if</span> ~ 孤单？ <span class="comment">% 非孤单 &quot;~&quot;取反</span></span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		</span><br><span class="line">		你想起一个人</span><br><span class="line">		<span class="keyword">if</span> 想找个人来陪</span><br><span class="line">			找！</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>使用<code>continue</code>关键字跳转，避免嵌套，提升可读性</p>
<h2 id="latex公式"><a class="markdownIt-Anchor" href="#latex公式"></a> Latex公式</h2>
<p>latex是特别常用且提升效率的公式编辑方法，推荐大家使用！</p>
<p>好处：输入公式时，手不再使用鼠标，全键盘操作</p>
<p>可以使用的场景：</p>
<ul>
<li>word</li>
<li>markdown</li>
<li>latex</li>
<li>mathtype</li>
<li>matlab</li>
<li>…</li>
</ul>
<h2 id="实时脚本做展示"><a class="markdownIt-Anchor" href="#实时脚本做展示"></a> 实时脚本做展示</h2>
<p>一般不用这个功能做开发，但是实时脚本是良好的展示工具</p>
<p>类似于 python 的 jupyter notebook</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231006133646069.png" alt="image-20231006133646069"></p>
<h2 id="数值精度问题"><a class="markdownIt-Anchor" href="#数值精度问题"></a> 数值精度问题</h2>
<p>数值精度问题普遍存在于计算机语言中，我们不讨论产生数值精度的具体原因，只需要知道存在这样的问题。</p>
<p>例如：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0.1</span> + <span class="number">0.2</span> == <span class="number">0.3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% ans =</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%  logical</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%   0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>在for循环中，需要避免以下的情况</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">0.0</span>:<span class="number">0.1</span>:<span class="number">1.0</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;-------------------&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">0.0</span>:<span class="number">0.1</span>:<span class="number">1.0</span>-<span class="built_in">i</span></span><br><span class="line">        k = <span class="number">1.0</span> - <span class="built_in">i</span> - <span class="built_in">j</span>;</span><br><span class="line">        <span class="built_in">disp</span>([<span class="built_in">i</span>,<span class="built_in">j</span>,k])</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% -------------------</span></span><br><span class="line"><span class="comment">%    0.7000         0    0.3000</span></span><br><span class="line"><span class="comment">%    0.7000    0.1000    0.2000</span></span><br><span class="line"><span class="comment">%    0.7000    0.2000    0.1000</span></span><br><span class="line"><span class="comment">%    0.7000    0.3000   -0.0000</span></span><br></pre></td></tr></table></figure>
<p>出现一个非常小的负数，极有可能导致bug</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">0</span>:<span class="number">10</span></span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;-------------------&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">0</span>:(<span class="number">10</span>-<span class="built_in">i</span>)</span><br><span class="line">        k = <span class="number">10</span> - <span class="built_in">i</span> - <span class="built_in">j</span>;</span><br><span class="line">        <span class="built_in">disp</span>([<span class="built_in">i</span>,<span class="built_in">j</span>,k] / <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">-------------------</span><br><span class="line">    <span class="number">0.7000</span>         <span class="number">0</span>    <span class="number">0.3000</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0.7000</span>    <span class="number">0.1000</span>    <span class="number">0.2000</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0.7000</span>    <span class="number">0.2000</span>    <span class="number">0.1000</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0.7000</span>    <span class="number">0.3000</span>         <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="在线matlab"><a class="markdownIt-Anchor" href="#在线matlab"></a> 在线Matlab</h2>
<p>电脑没有matlab？只要有许可证，就能使用matlab在线编程（<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/products/matlab-online.html%EF%BC%89%E3%80%82">https://ww2.mathworks.cn/products/matlab-online.html）。</a></p>
<h2 id="markdown语言"><a class="markdownIt-Anchor" href="#markdown语言"></a> Markdown语言</h2>
<p>本文档就是使用的markdown编写的，这是一种文本标记语言，实现文本的不同格式、样式。</p>
<h1 id="如何debug"><a class="markdownIt-Anchor" href="#如何debug"></a> 如何DEBUG</h1>
<h2 id="断点"><a class="markdownIt-Anchor" href="#断点"></a> 断点</h2>
<p>调试程序是每个编程语言必备的操作，没有人能完美写完一个复杂的代码并且没有任何小错误。当这些错误直观发现不了时，使用断点追踪程序每步的运算有助于发现问题。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001165505931.png" alt="image-20231001165505931"></p>
<h2 id="条件断点"><a class="markdownIt-Anchor" href="#条件断点"></a> 条件断点</h2>
<p>例如在这个循环中，每次<code>j=3</code>时就报错，我们增加一个条件断点，当满足这个条件时，程序暂停。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001165725593.png" alt="image-20231001165725593"></p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001165858415.png" alt="image-20231001165858415"></p>
<h2 id="错误暂停"><a class="markdownIt-Anchor" href="#错误暂停"></a> 错误暂停</h2>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001165922621.png" alt="image-20231001165922621"></p>
<p>建议把出现错误暂停勾选，这样程序会停止在出错的哪一行，有助于分析/复现问题。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001165952424.png" alt="image-20231001165952424"></p>
<h2 id="搜索问题"><a class="markdownIt-Anchor" href="#搜索问题"></a> 搜索问题</h2>
<p>当一个问题，自己不能解决的时候，我们通常会使用搜索引擎进行检索，如何获得问题的答案？</p>
<p>例如：</p>
<blockquote>
<p>我想删除一个cell数组中空的元胞，保留下非空的元胞</p>
</blockquote>
<p>一般我会用 “语言 + 关键词 ”搜索</p>
<ul>
<li>
<p>搜索方法：<code>MATLAB cell删除空元胞</code></p>
</li>
<li>
<p>结果质量：</p>
<ul>
<li>Matlab中文论坛 / 知乎 / 博客园</li>
<li>CSDN（垃圾堆里找吃的，但不代表都是垃圾） / 简书</li>
<li>百度知道 （几乎驴唇不对马嘴） / 其他小网站</li>
</ul>
</li>
</ul>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001170909421.png" alt="image-20231001170909421"></p>
<h2 id="font-colordd0000向他人提问font"><a class="markdownIt-Anchor" href="#font-colordd0000向他人提问font"></a> <font color="#dd0000">向他人提问</font></h2>
<p>向他人提问，包括同学、老师、网友等。</p>
<p>为什么向他人提问很重要？正确的提问方式有助于提升双方沟通效率，快速发现问题。</p>
<p><strong>错误的提问方式</strong></p>
<ol>
<li>
<p>不会截图 用手机拍照的</p>
<p><img src="/2024/07/12/2024-07-21-matlab/snap.jpg" alt="image-snap"></p>
</li>
<li>
<p>截图截一半 只截图报错信息traceback， 不截图代码的</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001171745717.png" alt="image-20231001171745717"></p>
</li>
<li>
<p>不截图前后文的</p>
<blockquote>
<p>为什么我这句代码报错了？</p>
</blockquote>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001172136136.png" alt="image-20231001172136136"></p>
</li>
<li>
<p>自己不思考、不检索，直接问别人的。</p>
<blockquote>
<p>我想删除一个cell数组中空的元胞，保留下非空的元胞，matlab怎么写？</p>
</blockquote>
</li>
</ol>
<p><strong>正确的提问方式</strong>（不仅适用于代码提问）</p>
<ul>
<li>
<p>尽可能详细说出你的问题</p>
</li>
<li>
<p>提供代码（如果是截图，截图要全面）</p>
</li>
<li>
<p>问题如何复现</p>
</li>
<li>
<p>你已经做了什么操作，但是还是不行</p>
</li>
<li>
<p>发送之前读一读你的提问</p>
<p>举例 1：</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001172945916.png" alt="image-20231001172945916"></p>
<p>举例 2：<img src="/2024/07/12/2024-07-21-matlab/image-20231001173153802.png" alt="image-20231001173153802"></p>
</li>
</ul>
<h2 id="文档"><a class="markdownIt-Anchor" href="#文档"></a> 文档</h2>
<p>如果你知道matlab的某个函数的名字，但是不会写，那么可以在matlab右上角搜索文档，也可以在命令行中使用<code>help 'fun_name'</code>获得文档。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001173452560.png" alt="image-20231001173452560"></p>
<p>此外，在命令行中输入<code>doc 'fun_name'</code>可以打开在线文档。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">doc <span class="built_in">zeros</span></span><br></pre></td></tr></table></figure>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001173620154.png" alt="image-20231001173620154"></p>
<h1 id="font-colordd0000外部功能font"><a class="markdownIt-Anchor" href="#font-colordd0000外部功能font"></a> <font color="#dd0000">外部功能</font></h1>
<h2 id="python"><a class="markdownIt-Anchor" href="#python"></a> Python</h2>
<p>很多时候，我们发现某个功能只在python中有，matlab中没有或者不如python好用。</p>
<p>这个时候，我们可以写一个python函数，然后让matlab调用这个py函数，再将结果处理成matlab可接收的类型即可。</p>
<p>举例来说，Gurobi对Python支持远远比matlab好，建模也更加方便，我们可以使用matlab调用python，python调用gurobi来实现：</p>
<p>首先，我们写一个python调用gurobi的函数<code>grbpy_v.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># grbpy_v.py</span></span><br><span class="line"><span class="keyword">import</span> gurobipy <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">model</span>(<span class="params">f, alpha, beta, gamma, mu, kappa</span>):</span><br><span class="line">    <span class="comment"># 集合</span></span><br><span class="line">    I = <span class="built_in">range</span>(<span class="built_in">len</span>(f))</span><br><span class="line">    P = <span class="built_in">range</span>(<span class="built_in">len</span>(alpha[<span class="number">0</span>]))</span><br><span class="line">    N = <span class="built_in">range</span>(<span class="built_in">len</span>(gamma[<span class="number">0</span>]))</span><br><span class="line">    M = <span class="built_in">range</span>(<span class="built_in">len</span>(beta[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 建模</span></span><br><span class="line">    model = gp.Model()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 变量</span></span><br><span class="line">    v = model.addVars((i <span class="keyword">for</span> i <span class="keyword">in</span> I), vtype = gp.GRB.BINARY, name =<span class="string">&#x27;v&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 目标</span></span><br><span class="line">    obj = gp.quicksum((f[i] - gp.quicksum(alpha[i,p] <span class="keyword">for</span> p <span class="keyword">in</span> P) \</span><br><span class="line">                            - gp.quicksum(beta[i,m] - mu[i,m] <span class="keyword">for</span> m <span class="keyword">in</span> M)\</span><br><span class="line">                            - gp.quicksum(gamma[i,n] - kappa[i,n] <span class="keyword">for</span> n <span class="keyword">in</span> N)) * v[i] <span class="keyword">for</span> i <span class="keyword">in</span> I) \</span><br><span class="line">        - gp.quicksum(mu[i,m] <span class="keyword">for</span> i <span class="keyword">in</span> I <span class="keyword">for</span> m <span class="keyword">in</span> M) \</span><br><span class="line">        - gp.quicksum(kappa[i,n] <span class="keyword">for</span> i <span class="keyword">in</span> I <span class="keyword">for</span> n <span class="keyword">in</span> N)</span><br><span class="line">    model.setObjective(obj, sense = gp.GRB.MINIMIZE)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 约束</span></span><br><span class="line">    <span class="comment"># 无</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 求解</span></span><br><span class="line">    model.Params.OutputFlag = <span class="number">0</span></span><br><span class="line">    model.Params.MIPGap = <span class="number">0.01</span></span><br><span class="line">    model.optimize()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 整理</span></span><br><span class="line">    loc = np.zeros([<span class="number">1</span>,<span class="built_in">len</span>(f)])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> I:</span><br><span class="line">        <span class="keyword">if</span> math.isclose(v[i].X, <span class="number">1</span>):</span><br><span class="line">            loc[<span class="number">0</span>,i] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    obj_val = model.getAttr(<span class="string">&#x27;ObjVal&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (loc, obj_val)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后，我们写一个matlab脚本（函数）调用这个py函数</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">py.importlib.reload(py.importlib.import_module(<span class="string">&#x27;grbpy_v&#x27;</span>));</span><br><span class="line"></span><br><span class="line">fix_ws_py = py.numpy.array(fixed_ws);</span><br><span class="line">alpha_py  = py.numpy.array(alpha);</span><br><span class="line">beta_py   = py.numpy.array(<span class="built_in">beta</span>);</span><br><span class="line">mu_py     = py.numpy.array(mu);</span><br><span class="line">gamma_py  = py.numpy.array(<span class="built_in">gamma</span>);</span><br><span class="line">kappa_py  = py.numpy.array(kappa);</span><br><span class="line"></span><br><span class="line">res = py.grbpy_v.model(fix_ws_py, alpha_py, beta_py, gamma_py, mu_py, kappa_py);</span><br></pre></td></tr></table></figure>
<p>注意上述存在类型转换，需要把matlab的矩阵转成python的numpy矩阵才可以使用。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.mathworks.com/help/releases/R2023b/matlab/call-python-libraries.html?s_tid=doc_srchtitle">从 MATLAB 中调用 Python</a></p>
<h2 id="gurobi-运筹优化专业"><a class="markdownIt-Anchor" href="#gurobi-运筹优化专业"></a> Gurobi （运筹优化专业）</h2>
<p>Gurobi是一款求解器，做运筹优化方面常常会用到，这里将介绍直接使用matlab调用gurobi，不借助其他软件或包。</p>
<p>来源于Guorbi官方文档：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">facility</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Copyright 2023, Gurobi Optimization, LLC</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% Facility location: a company currently ships its product from 5 plants</span></span><br><span class="line"><span class="comment">% to 4 warehouses. It is considering closing some plants to reduce</span></span><br><span class="line"><span class="comment">% costs. What plant(s) should the company close, in order to minimize</span></span><br><span class="line"><span class="comment">% transportation and fixed costs?</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% Note that this example uses lists instead of dictionaries.  Since</span></span><br><span class="line"><span class="comment">% it does not work with sparse data, lists are a reasonable option.</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% Based on an example from Frontline Systems:</span></span><br><span class="line"><span class="comment">%   http://www.solver.com/disfacility.htm</span></span><br><span class="line"><span class="comment">% Used with permission.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% define primitive data</span></span><br><span class="line">nPlants     = <span class="number">5</span>;</span><br><span class="line">nWarehouses = <span class="number">4</span>;</span><br><span class="line"><span class="comment">% Warehouse demand in thousands of units</span></span><br><span class="line">Demand      = [<span class="number">15</span>; <span class="number">18</span>; <span class="number">14</span>; <span class="number">20</span>];</span><br><span class="line"><span class="comment">% Plant capacity in thousands of units</span></span><br><span class="line">Capacity    = [<span class="number">20</span>; <span class="number">22</span>; <span class="number">17</span>; <span class="number">19</span>; <span class="number">18</span>];</span><br><span class="line"><span class="comment">% Fixed costs for each plant</span></span><br><span class="line">FixedCosts  = [<span class="number">12000</span>; <span class="number">15000</span>; <span class="number">17000</span>; <span class="number">13000</span>; <span class="number">16000</span>];</span><br><span class="line"><span class="comment">% Transportation costs per thousand units</span></span><br><span class="line">TransCosts  = [</span><br><span class="line">    <span class="number">4000</span>; <span class="number">2000</span>; <span class="number">3000</span>; <span class="number">2500</span>; <span class="number">4500</span>;</span><br><span class="line">    <span class="number">2500</span>; <span class="number">2600</span>; <span class="number">3400</span>; <span class="number">3000</span>; <span class="number">4000</span>;</span><br><span class="line">    <span class="number">1200</span>; <span class="number">1800</span>; <span class="number">2600</span>; <span class="number">4100</span>; <span class="number">3000</span>;</span><br><span class="line">    <span class="number">2200</span>; <span class="number">2600</span>; <span class="number">3100</span>; <span class="number">3700</span>; <span class="number">3200</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">% Index helper function</span></span><br><span class="line">flowidx = @(w, p) nPlants * w + p;</span><br><span class="line"></span><br><span class="line"><span class="comment">% Build model</span></span><br><span class="line">model.modelname = <span class="string">&#x27;facility&#x27;</span>;</span><br><span class="line">model.modelsense = <span class="string">&#x27;min&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% Set data for variables</span></span><br><span class="line">ncol = nPlants + nPlants * nWarehouses;</span><br><span class="line">model.lb    = <span class="built_in">zeros</span>(ncol, <span class="number">1</span>);</span><br><span class="line">model.ub    = [<span class="built_in">ones</span>(nPlants, <span class="number">1</span>); <span class="built_in">inf</span>(nPlants * nWarehouses, <span class="number">1</span>)];</span><br><span class="line">model.obj   = [FixedCosts; TransCosts];</span><br><span class="line">model.vtype = [<span class="built_in">repmat</span>(<span class="string">&#x27;B&#x27;</span>, nPlants, <span class="number">1</span>); <span class="built_in">repmat</span>(<span class="string">&#x27;C&#x27;</span>, nPlants * nWarehouses, <span class="number">1</span>)];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p = <span class="number">1</span>:nPlants</span><br><span class="line">    model.varnames&#123;p&#125; = sprintf(<span class="string">&#x27;Open%d&#x27;</span>, p);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> w = <span class="number">1</span>:nWarehouses</span><br><span class="line">    <span class="keyword">for</span> p = <span class="number">1</span>:nPlants</span><br><span class="line">        v = flowidx(w, p);</span><br><span class="line">        model.varnames&#123;v&#125; = sprintf(<span class="string">&#x27;Trans%d,%d&#x27;</span>, w, p);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Set data for constraints and matrix</span></span><br><span class="line">nrow = nPlants + nWarehouses;</span><br><span class="line">model.A     = sparse(nrow, ncol);</span><br><span class="line">model.rhs   = [<span class="built_in">zeros</span>(nPlants, <span class="number">1</span>); Demand];</span><br><span class="line">model.sense = [<span class="built_in">repmat</span>(<span class="string">&#x27;&lt;&#x27;</span>, nPlants, <span class="number">1</span>); <span class="built_in">repmat</span>(<span class="string">&#x27;=&#x27;</span>, nWarehouses, <span class="number">1</span>)];</span><br><span class="line"></span><br><span class="line"><span class="comment">% Production constraints</span></span><br><span class="line"><span class="keyword">for</span> p = <span class="number">1</span>:nPlants</span><br><span class="line">    <span class="keyword">for</span> w = <span class="number">1</span>:nWarehouses</span><br><span class="line">        model.A(p, p) = -Capacity(p);</span><br><span class="line">        model.A(p, flowidx(w, p)) = <span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    model.constrnames&#123;p&#125; = sprintf(<span class="string">&#x27;Capacity%d&#x27;</span>, p);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Demand constraints</span></span><br><span class="line"><span class="keyword">for</span> w = <span class="number">1</span>:nWarehouses</span><br><span class="line">    <span class="keyword">for</span> p = <span class="number">1</span>:nPlants</span><br><span class="line">        model.A(nPlants+w, flowidx(w, p)) = <span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    model.constrnames&#123;nPlants+w&#125; = sprintf(<span class="string">&#x27;Demand%d&#x27;</span>, w);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Save model</span></span><br><span class="line">gurobi_write(model,<span class="string">&#x27;facility_m.lp&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% Guess at the starting point: close the plant with the highest fixed</span></span><br><span class="line"><span class="comment">% costs; open all others first open all plants</span></span><br><span class="line">model.start = [<span class="built_in">ones</span>(nPlants, <span class="number">1</span>); <span class="built_in">inf</span>(nPlants * nWarehouses, <span class="number">1</span>)];</span><br><span class="line">[~, idx] = <span class="built_in">max</span>(FixedCosts);</span><br><span class="line">model.start(idx) = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% Set parameters</span></span><br><span class="line">params.method = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% Optimize</span></span><br><span class="line">res = gurobi(model, params);</span><br><span class="line"></span><br><span class="line"><span class="comment">% Print solution</span></span><br><span class="line"><span class="keyword">if</span> strcmp(res.status, <span class="string">&#x27;OPTIMAL&#x27;</span>)</span><br><span class="line">    fprintf(<span class="string">&#x27;\nTotal Costs: %g\n&#x27;</span>, res.objval);</span><br><span class="line">    fprintf(<span class="string">&#x27;solution:\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> p = <span class="number">1</span>:nPlants</span><br><span class="line">        <span class="keyword">if</span> res.x(p) &gt; <span class="number">0.99</span></span><br><span class="line">            fprintf(<span class="string">&#x27;Plant %d open:\n&#x27;</span>, p);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">for</span> w = <span class="number">1</span>:nWarehouses</span><br><span class="line">            <span class="keyword">if</span> res.x(flowidx(w, p)) &gt; <span class="number">0.0001</span></span><br><span class="line">                fprintf(<span class="string">&#x27;  Transport %g units to warehouse %d\n&#x27;</span>, res.x(flowidx(w, p)), w);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    fprintf(<span class="string">&#x27;\n No solution\n&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>想表达的是，gurobi对matlab很不友好：</p>
<ul>
<li>系数矩阵必须是自己算明白索引后，转换为一个稀疏矩阵。</li>
<li>很难按照约束一条一条添加</li>
<li>有些gurobi功能matlab不能使用</li>
</ul>
<p>同样模型，python的版本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3.7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copyright 2023, Gurobi Optimization, LLC</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Facility location: a company currently ships its product from 5 plants</span></span><br><span class="line"><span class="comment"># to 4 warehouses. It is considering closing some plants to reduce</span></span><br><span class="line"><span class="comment"># costs. What plant(s) should the company close, in order to minimize</span></span><br><span class="line"><span class="comment"># transportation and fixed costs?</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Note that this example uses lists instead of dictionaries.  Since</span></span><br><span class="line"><span class="comment"># it does not work with sparse data, lists are a reasonable option.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Based on an example from Frontline Systems:</span></span><br><span class="line"><span class="comment">#   http://www.solver.com/disfacility.htm</span></span><br><span class="line"><span class="comment"># Used with permission.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gurobipy <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> gurobipy <span class="keyword">import</span> GRB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Warehouse demand in thousands of units</span></span><br><span class="line">demand = [<span class="number">15</span>, <span class="number">18</span>, <span class="number">14</span>, <span class="number">20</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plant capacity in thousands of units</span></span><br><span class="line">capacity = [<span class="number">20</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">18</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fixed costs for each plant</span></span><br><span class="line">fixedCosts = [<span class="number">12000</span>, <span class="number">15000</span>, <span class="number">17000</span>, <span class="number">13000</span>, <span class="number">16000</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Transportation costs per thousand units</span></span><br><span class="line">transCosts = [[<span class="number">4000</span>, <span class="number">2000</span>, <span class="number">3000</span>, <span class="number">2500</span>, <span class="number">4500</span>],</span><br><span class="line">              [<span class="number">2500</span>, <span class="number">2600</span>, <span class="number">3400</span>, <span class="number">3000</span>, <span class="number">4000</span>],</span><br><span class="line">              [<span class="number">1200</span>, <span class="number">1800</span>, <span class="number">2600</span>, <span class="number">4100</span>, <span class="number">3000</span>],</span><br><span class="line">              [<span class="number">2200</span>, <span class="number">2600</span>, <span class="number">3100</span>, <span class="number">3700</span>, <span class="number">3200</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Range of plants and warehouses</span></span><br><span class="line">plants = <span class="built_in">range</span>(<span class="built_in">len</span>(capacity))</span><br><span class="line">warehouses = <span class="built_in">range</span>(<span class="built_in">len</span>(demand))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Model</span></span><br><span class="line">m = gp.Model(<span class="string">&quot;facility&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plant open decision variables: open[p] == 1 if plant p is open.</span></span><br><span class="line"><span class="built_in">open</span> = m.addVars(plants,</span><br><span class="line">                 vtype=GRB.BINARY,</span><br><span class="line">                 obj=fixedCosts,</span><br><span class="line">                 name=<span class="string">&quot;open&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Transportation decision variables: transport[w,p] captures the</span></span><br><span class="line"><span class="comment"># optimal quantity to transport to warehouse w from plant p</span></span><br><span class="line">transport = m.addVars(warehouses, plants, obj=transCosts, name=<span class="string">&quot;trans&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># You could use Python looping constructs and m.addVar() to create</span></span><br><span class="line"><span class="comment"># these decision variables instead.  The following would be equivalent</span></span><br><span class="line"><span class="comment"># to the preceding two statements...</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># open = []</span></span><br><span class="line"><span class="comment"># for p in plants:</span></span><br><span class="line"><span class="comment">#     open.append(m.addVar(vtype=GRB.BINARY,</span></span><br><span class="line"><span class="comment">#                          obj=fixedCosts[p],</span></span><br><span class="line"><span class="comment">#                          name=&quot;open[%d]&quot; % p))</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># transport = []</span></span><br><span class="line"><span class="comment"># for w in warehouses:</span></span><br><span class="line"><span class="comment">#     transport.append([])</span></span><br><span class="line"><span class="comment">#     for p in plants:</span></span><br><span class="line"><span class="comment">#         transport[w].append(m.addVar(obj=transCosts[w][p],</span></span><br><span class="line"><span class="comment">#                                      name=&quot;trans[%d,%d]&quot; % (w, p)))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The objective is to minimize the total fixed and variable costs</span></span><br><span class="line">m.ModelSense = GRB.MINIMIZE</span><br><span class="line"></span><br><span class="line"><span class="comment"># Production constraints</span></span><br><span class="line"><span class="comment"># Note that the right-hand limit sets the production to zero if the plant</span></span><br><span class="line"><span class="comment"># is closed</span></span><br><span class="line">m.addConstrs(</span><br><span class="line">    (transport.<span class="built_in">sum</span>(<span class="string">&#x27;*&#x27;</span>, p) &lt;= capacity[p]*<span class="built_in">open</span>[p] <span class="keyword">for</span> p <span class="keyword">in</span> plants), <span class="string">&quot;Capacity&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using Python looping constructs, the preceding would be...</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># for p in plants:</span></span><br><span class="line"><span class="comment">#     m.addConstr(sum(transport[w][p] for w in warehouses)</span></span><br><span class="line"><span class="comment">#                 &lt;= capacity[p] * open[p], &quot;Capacity[%d]&quot; % p)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Demand constraints</span></span><br><span class="line">m.addConstrs(</span><br><span class="line">    (transport.<span class="built_in">sum</span>(w) == demand[w] <span class="keyword">for</span> w <span class="keyword">in</span> warehouses),</span><br><span class="line">    <span class="string">&quot;Demand&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ... and the preceding would be ...</span></span><br><span class="line"><span class="comment"># for w in warehouses:</span></span><br><span class="line"><span class="comment">#     m.addConstr(sum(transport[w][p] for p in plants) == demand[w],</span></span><br><span class="line"><span class="comment">#                 &quot;Demand[%d]&quot; % w)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Save model</span></span><br><span class="line">m.write(<span class="string">&#x27;facilityPY.lp&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Guess at the starting point: close the plant with the highest fixed costs;</span></span><br><span class="line"><span class="comment"># open all others</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># First open all plants</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> plants:</span><br><span class="line">    <span class="built_in">open</span>[p].Start = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Now close the plant with the highest fixed cost</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Initial guess:&#x27;</span>)</span><br><span class="line">maxFixed = <span class="built_in">max</span>(fixedCosts)</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> plants:</span><br><span class="line">    <span class="keyword">if</span> fixedCosts[p] == maxFixed:</span><br><span class="line">        <span class="built_in">open</span>[p].Start = <span class="number">0.0</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Closing plant %s&#x27;</span> % p)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use barrier to solve root relaxation</span></span><br><span class="line">m.Params.Method = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solve</span></span><br><span class="line">m.optimize()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print solution</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\nTOTAL COSTS: %g&#x27;</span> % m.ObjVal)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;SOLUTION:&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> plants:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">open</span>[p].X &gt; <span class="number">0.99</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Plant %s open&#x27;</span> % p)</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> warehouses:</span><br><span class="line">            <span class="keyword">if</span> transport[w, p].X &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;  Transport %g units to warehouse %s&#x27;</span> %</span><br><span class="line">                      (transport[w, p].X, w))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Plant %s closed!&#x27;</span> % p)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="yalmip-运筹优化方向"><a class="markdownIt-Anchor" href="#yalmip-运筹优化方向"></a> Yalmip （运筹优化方向）</h2>
<p>yalmip是一款基于matlab进行数学建模的包，或者说是一种基于matlab的建模语言，使用yalmip的好处是解决了matlab建模的痛点，并且可以调用多个求解器对模型进行求解。</p>
<p>然而，求解器方面，如果用gurobi / COPT，则一般使用python建模。如果用cplex，则使用java。</p>
<p>如果不会别的语言，必须使用matlab进行建模和求解的话，yalmip无疑是最好的选择。</p>
<h2 id="gramm画图"><a class="markdownIt-Anchor" href="#gramm画图"></a> gramm（画图）</h2>
<p>gramm是基于matlab开发的一个绘图工具，可以画很多好看的图。</p>
<p>matlab的图一般都很丑，需要自己不断调试。而gramm默认的配色，基本可以直接使用。</p>
<p><img src="/2024/07/12/2024-07-21-matlab/image-20231001184526448.png" alt="image-20231001184526448"></p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.mathworks.com/matlabcentral/fileexchange/54465-gramm-complete-data-visualization-toolbox-ggplot2-r-like">https://www.mathworks.com/matlabcentral/fileexchange/54465-gramm-complete-data-visualization-toolbox-ggplot2-r-like</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/piermorel/gramm">https://github.com/piermorel/gramm</a></p>
<h1 id="one-more-thing"><a class="markdownIt-Anchor" href="#one-more-thing"></a> One more thing</h1>
<p>科研常用工具列表，成为一个合格的板砖人（科研民工）</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>价格</th>
<th>用处</th>
</tr>
</thead>
<tbody>
<tr>
<td>Office三件套</td>
<td>学校提供</td>
<td>略</td>
</tr>
<tr>
<td>Mathtype</td>
<td>收费</td>
<td>数学公式编辑（推荐搭配latex数学命令使用）</td>
</tr>
<tr>
<td>Typora</td>
<td>收费</td>
<td>markdown编辑器，本次分享使用markdown完成</td>
</tr>
<tr>
<td>VScode</td>
<td>免费</td>
<td>地表最强编辑器，我用vscode开发python, latex, markdown</td>
</tr>
<tr>
<td>Notion</td>
<td>免费</td>
<td>个人知识库（上手很慢，但是可以很好规划你的生活）</td>
</tr>
<tr>
<td>Endnote</td>
<td>学校提供</td>
<td>个人文献库（直接插入国标引用格式到word）</td>
</tr>
<tr>
<td>Calibre</td>
<td>免费</td>
<td>个人图书馆</td>
</tr>
<tr>
<td>百度云</td>
<td>功能收费</td>
<td>备份+同步（一年不到200块，同步文件+备份文件）</td>
</tr>
<tr>
<td>Office 365</td>
<td>收费</td>
<td>与Office年度版本不同，这是订阅制的office，享受更多功能+1T 云盘</td>
</tr>
<tr>
<td>Acrobat DC</td>
<td>收费</td>
<td>PDF编辑器</td>
</tr>
<tr>
<td>Latex</td>
<td>免费</td>
<td>写期刊论文使用，直接输出pdf</td>
</tr>
<tr>
<td>Overleaf / Slagger</td>
<td>免费</td>
<td>在线latex</td>
</tr>
<tr>
<td>Powertoys</td>
<td>免费</td>
<td>Windows拓展工具（非常强大，保持唤醒、取色、分屏等等等）</td>
</tr>
</tbody>
</table>
<h1 id="结语"><a class="markdownIt-Anchor" href="#结语"></a> 结语</h1>
<h2 id="matlab优缺点"><a class="markdownIt-Anchor" href="#matlab优缺点"></a> Matlab优缺点</h2>
<p>优点：</p>
<ul>
<li>Matlab (matrix laboratory) 是一流的矩阵(Matrix)计算工具，提供了强大的矩阵计算方法</li>
<li>预先定义好的功能，上手容易、语法简单（个人觉得比python还简单）</li>
<li>图形化的界面，独立的平台</li>
<li>来自官方的工具箱，长期支持和维护</li>
</ul>
<p>缺点：</p>
<ul>
<li>一些数据结构在matlab中是没有原生支持的（字典结构是最近加入的,以前使用字典，优先队列等需要调用java）</li>
<li>商业软件很少有公司使用，生存在科研机构，底层是闭源的</li>
<li>运行速度较慢</li>
</ul>
<h2 id="如何使用matlab"><a class="markdownIt-Anchor" href="#如何使用matlab"></a> 如何使用Matlab</h2>
<ul>
<li>使用正版，获得更多的技术支持，工具箱，社区等。</li>
<li>使用新版，获得更多的功能，更快的运行，更美的界面。</li>
</ul>
<h2 id="怎么学matlab"><a class="markdownIt-Anchor" href="#怎么学matlab"></a> 怎么学Matlab</h2>
<ul>
<li>只进行数值计算则matlab不是唯一选择（python, java等都可以），matlab的精髓是工具箱和仿真。</li>
<li>任何一门语言的技能成长过程是多写多看多练，练习中成长。（编程语言不是自然语言，朗读代码不会获得进步。）</li>
</ul>
<hr>
<p>希望各位能从今天的分享中收获自己想要的。感谢各位！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Yu Runfeng</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
